{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/lib/extraction-context.ts"],"sourcesContent":["import { TreeNode } from \"./tree\";\n\nexport type ExtractionContext = {\n  mode: \"local\" | \"api\" | \"s3\";\n  metadata: {\n    name: string;\n    size: number;\n    source: string;\n    cleansedId?: string;\n    status?: string;\n    uploadedAt: number;\n    sourceIdentifier?: string;\n    sourceType?: string;\n  };\n  sourceUri?: string;\n  snapshotId?: string;\n  /**\n   * @deprecated Legacy fields retained for backwards compatibility.\n   */\n  tree?: TreeNode[];\n  rawJson?: string;\n  backendPayload?: unknown;\n};\n\nexport type PersistenceFailureReason = \"ssr\" | \"quota\" | \"unknown\";\n\nexport type PersistenceResult = {\n  ok: boolean;\n  reason?: PersistenceFailureReason;\n  usedFallback?: boolean;\n};\n\nconst STORAGE_KEY = \"extraction-context\";\nconst CLEANSED_STORAGE_KEY = \"cleansed-context\";\nconst ENRICHMENT_STORAGE_KEY = \"enrichment-context\";\n\nconst MAX_CLEANSED_ITEMS = 150;\nconst MAX_CLEANSED_RAW_BODY_CHARS = 200_000;\n\nconst isQuotaExceededError = (error: unknown): error is DOMException => {\n  if (typeof DOMException === \"undefined\") return false;\n\n  return (\n    error instanceof DOMException &&\n    (error.name === \"QuotaExceededError\" ||\n      error.name === \"NS_ERROR_DOM_QUOTA_REACHED\" ||\n      error.code === 22 ||\n      error.code === 1014)\n  );\n};\n\nconst MAX_EXTRACTION_RAW_BODY_CHARS = 500_000;\n\nconst persistToSessionStorage = (key: string, payload: unknown): PersistenceResult => {\n  if (typeof window === \"undefined\") {\n    return { ok: false, reason: \"ssr\" };\n  }\n\n  try {\n    sessionStorage.setItem(key, JSON.stringify(payload));\n    return { ok: true };\n  } catch (error) {\n    if (isQuotaExceededError(error)) {\n      console.warn(`Session storage quota exceeded while saving '${key}'.`);\n      return { ok: false, reason: \"quota\" };\n    }\n\n    console.error(`Failed to persist '${key}' to sessionStorage`, error);\n    return { ok: false, reason: \"unknown\" };\n  }\n};\n\nconst safeLoad = <T>(serialized: string | null): T | null => {\n  if (!serialized) return null;\n\n  try {\n    return JSON.parse(serialized) as T;\n  } catch (error) {\n    console.error(\"Failed to parse session storage payload\", error);\n    return null;\n  }\n};\n\nconst sanitizeExtractionContext = (payload: ExtractionContext): ExtractionContext => {\n  const next: ExtractionContext = {\n    ...payload,\n    backendPayload: undefined,\n  };\n\n  if (typeof next.rawJson === \"string\" && next.rawJson.length > MAX_EXTRACTION_RAW_BODY_CHARS) {\n    next.rawJson = next.rawJson.slice(0, MAX_EXTRACTION_RAW_BODY_CHARS);\n  }\n\n  return next;\n};\n\nexport const saveExtractionContext = (payload: ExtractionContext) => {\n  const sanitized = sanitizeExtractionContext(payload);\n  return persistToSessionStorage(STORAGE_KEY, sanitized);\n};\n\nexport const loadExtractionContext = (): ExtractionContext | null => {\n  if (typeof window === \"undefined\") return null;\n  const stored = sessionStorage.getItem(STORAGE_KEY);\n  return safeLoad<ExtractionContext>(stored);\n};\n\nexport const clearExtractionContext = () => {\n  if (typeof window === \"undefined\") return;\n  sessionStorage.removeItem(STORAGE_KEY);\n};\n\nexport type CleansedContext = {\n  metadata: ExtractionContext[\"metadata\"];\n  items: unknown[];\n  rawBody?: string;\n  status?: string;\n  itemsTruncated?: boolean;\n  rawBodyTruncated?: boolean;\n  fallbackReason?: PersistenceFailureReason;\n};\n\nconst sanitizeCleansedPayload = (payload: CleansedContext): CleansedContext => {\n  const next: CleansedContext = {\n    ...payload,\n    items: Array.isArray(payload.items) ? [...payload.items] : [],\n  };\n\n  if (next.items.length > MAX_CLEANSED_ITEMS) {\n    next.items = next.items.slice(0, MAX_CLEANSED_ITEMS);\n    next.itemsTruncated = true;\n  }\n\n  if (typeof next.rawBody === \"string\" && next.rawBody.length > MAX_CLEANSED_RAW_BODY_CHARS) {\n    next.rawBody = next.rawBody.slice(0, MAX_CLEANSED_RAW_BODY_CHARS);\n    next.rawBodyTruncated = true;\n  }\n\n  return next;\n};\n\nexport const saveCleansedContext = (payload: CleansedContext): PersistenceResult => {\n  const sanitized = sanitizeCleansedPayload(payload);\n  const result = persistToSessionStorage(CLEANSED_STORAGE_KEY, sanitized);\n\n  if (!result.ok && result.reason === \"quota\") {\n    const fallbackPayload: CleansedContext = {\n      metadata: sanitized.metadata,\n      status: sanitized.status,\n      items: [],\n      fallbackReason: \"quota\",\n    };\n    const fallbackResult = persistToSessionStorage(CLEANSED_STORAGE_KEY, fallbackPayload);\n    if (fallbackResult.ok) {\n      return {\n        ok: true,\n        reason: \"quota\",\n        usedFallback: true,\n      };\n    }\n    return fallbackResult;\n  }\n\n  return result;\n};\n\nexport const loadCleansedContext = (): CleansedContext | null => {\n  if (typeof window === \"undefined\") return null;\n  const stored = sessionStorage.getItem(CLEANSED_STORAGE_KEY);\n  return safeLoad<CleansedContext>(stored);\n};\n\nexport const clearCleansedContext = () => {\n  if (typeof window === \"undefined\") return;\n  sessionStorage.removeItem(CLEANSED_STORAGE_KEY);\n};\n\nexport type EnrichmentStatusEntry = {\n  status: string;\n  timestamp: number;\n};\n\nexport type EnrichmentContext = {\n  metadata: ExtractionContext[\"metadata\"];\n  items?: unknown[];\n  startedAt: number;\n  statusHistory: EnrichmentStatusEntry[];\n};\n\nexport const saveEnrichmentContext = (payload: EnrichmentContext) => {\n  return persistToSessionStorage(ENRICHMENT_STORAGE_KEY, payload);\n};\n\nexport const loadEnrichmentContext = (): EnrichmentContext | null => {\n  if (typeof window === \"undefined\") return null;\n  const stored = sessionStorage.getItem(ENRICHMENT_STORAGE_KEY);\n  return safeLoad<EnrichmentContext>(stored);\n};\n\nexport const clearEnrichmentContext = () => {\n  if (typeof window === \"undefined\") return;\n  sessionStorage.removeItem(ENRICHMENT_STORAGE_KEY);\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/components/PipelineTracker.tsx"],"sourcesContent":["\"use client\";\n\nimport clsx from \"clsx\";\n\ntype StepId = \"ingestion\" | \"extraction\" | \"cleansing\" | \"enrichment\" | \"qa\";\n\nconst STEPS: Array<{ id: StepId; label: string }> = [\n  { id: \"ingestion\", label: \"Ingestion\" },\n  { id: \"extraction\", label: \"Extraction\" },\n  { id: \"cleansing\", label: \"Cleansing\" },\n  { id: \"enrichment\", label: \"Data Enrichment\" },\n  { id: \"qa\", label: \"Content QA\" },\n];\n\nexport function PipelineTracker({ current }: { current: StepId }) {\n  const currentIndex = STEPS.findIndex((step) => step.id === current);\n\n  return (\n    <nav className=\"hidden flex-wrap items-center gap-2 text-xs font-semibold text-slate-500 md:flex\">\n      {STEPS.map((step, index) => {\n        const status =\n          index < currentIndex ? \"done\" : index === currentIndex ? \"current\" : \"upcoming\";\n        return (\n          <div key={step.id} className=\"flex items-center gap-2\">\n            <span\n              className={clsx(\n                \"rounded-full px-3 py-1 transition\",\n                status === \"current\"\n                  ? \"bg-indigo-50 text-indigo-600\"\n                  : status === \"done\"\n                    ? \"bg-emerald-50 text-emerald-700\"\n                    : \"bg-slate-100 text-slate-500\",\n              )}\n            >\n              {step.label}\n            </span>\n            {index < STEPS.length - 1 && <span className=\"text-slate-300\">—</span>}\n          </div>\n        );\n      })}\n    </nav>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAMA,MAAM,QAA8C;IAClD;QAAE,IAAI;QAAa,OAAO;IAAY;IACtC;QAAE,IAAI;QAAc,OAAO;IAAa;IACxC;QAAE,IAAI;QAAa,OAAO;IAAY;IACtC;QAAE,IAAI;QAAc,OAAO;IAAkB;IAC7C;QAAE,IAAI;QAAM,OAAO;IAAa;CACjC;AAEM,SAAS,gBAAgB,EAAE,OAAO,EAAuB;IAC9D,MAAM,eAAe,MAAM,SAAS,CAAC,CAAC,OAAS,KAAK,EAAE,KAAK;IAE3D,qBACE,4OAAC;QAAI,WAAU;kBACZ,MAAM,GAAG,CAAC,CAAC,MAAM;YAChB,MAAM,SACJ,QAAQ,eAAe,SAAS,UAAU,eAAe,YAAY;YACvE,qBACE,4OAAC;gBAAkB,WAAU;;kCAC3B,4OAAC;wBACC,WAAW,IAAA,kMAAI,EACb,qCACA,WAAW,YACP,iCACA,WAAW,SACT,mCACA;kCAGP,KAAK,KAAK;;;;;;oBAEZ,QAAQ,MAAM,MAAM,GAAG,mBAAK,4OAAC;wBAAK,WAAU;kCAAiB;;;;;;;eAbtD,KAAK,EAAE;;;;;QAgBrB;;;;;;AAGN;KA5BgB"}},
    {"offset": {"line": 241, "column": 0}, "map": {"version":3,"sources":["file:///Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/lib/source.ts"],"sourcesContent":["export const pickString = (value: unknown): string | undefined => {\n  if (typeof value !== \"string\") return undefined;\n  const trimmed = value.trim();\n  return trimmed.length ? trimmed : undefined;\n};\n\nexport const inferSourceType = (\n  explicitType?: string,\n  identifier?: string,\n  fallback?: string,\n): string | undefined => {\n  const normalized = explicitType?.toLowerCase();\n  if (normalized) {\n    return normalized;\n  }\n  if (!identifier) {\n    return fallback;\n  }\n  const token = identifier.toLowerCase();\n  if (token.startsWith(\"file-upload\") || token.startsWith(\"local:\")) {\n    return \"file\";\n  }\n  if (token.startsWith(\"api-payload\") || token.includes(\"api\")) {\n    return \"api\";\n  }\n  if (token.startsWith(\"s3://\") || token.includes(\"s3\")) {\n    return \"s3\";\n  }\n  if (token.startsWith(\"classpath:\")) {\n    return \"classpath\";\n  }\n  return fallback;\n};\n\nexport const describeSourceLabel = (\n  type?: string,\n  fallback = \"Unknown source\",\n): string => {\n  if (!type) return fallback;\n  const normalized = type.toLowerCase();\n  if (normalized.includes(\"api\")) return \"API payload\";\n  if (normalized.includes(\"s3\") || normalized.includes(\"cloud\")) return \"S3 / Cloud\";\n  if (normalized.includes(\"class\")) return \"Classpath resource\";\n  if (normalized.includes(\"local\")) return \"Local upload\";\n  if (normalized.includes(\"file\")) return \"File upload\";\n  return type;\n};"],"names":[],"mappings":";;;;;;;;AAAO,MAAM,aAAa,CAAC;IACzB,IAAI,OAAO,UAAU,UAAU,OAAO;IACtC,MAAM,UAAU,MAAM,IAAI;IAC1B,OAAO,QAAQ,MAAM,GAAG,UAAU;AACpC;AAEO,MAAM,kBAAkB,CAC7B,cACA,YACA;IAEA,MAAM,aAAa,cAAc;IACjC,IAAI,YAAY;QACd,OAAO;IACT;IACA,IAAI,CAAC,YAAY;QACf,OAAO;IACT;IACA,MAAM,QAAQ,WAAW,WAAW;IACpC,IAAI,MAAM,UAAU,CAAC,kBAAkB,MAAM,UAAU,CAAC,WAAW;QACjE,OAAO;IACT;IACA,IAAI,MAAM,UAAU,CAAC,kBAAkB,MAAM,QAAQ,CAAC,QAAQ;QAC5D,OAAO;IACT;IACA,IAAI,MAAM,UAAU,CAAC,YAAY,MAAM,QAAQ,CAAC,OAAO;QACrD,OAAO;IACT;IACA,IAAI,MAAM,UAAU,CAAC,eAAe;QAClC,OAAO;IACT;IACA,OAAO;AACT;AAEO,MAAM,sBAAsB,CACjC,MACA,WAAW,gBAAgB;IAE3B,IAAI,CAAC,MAAM,OAAO;IAClB,MAAM,aAAa,KAAK,WAAW;IACnC,IAAI,WAAW,QAAQ,CAAC,QAAQ,OAAO;IACvC,IAAI,WAAW,QAAQ,CAAC,SAAS,WAAW,QAAQ,CAAC,UAAU,OAAO;IACtE,IAAI,WAAW,QAAQ,CAAC,UAAU,OAAO;IACzC,IAAI,WAAW,QAAQ,CAAC,UAAU,OAAO;IACzC,IAAI,WAAW,QAAQ,CAAC,SAAS,OAAO;IACxC,OAAO;AACT"}},
    {"offset": {"line": 294, "column": 0}, "map": {"version":3,"sources":["file:///Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/cleansing/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport {\n  clearCleansedContext,\n  loadCleansedContext,\n  saveEnrichmentContext,\n  type CleansedContext,\n} from \"@/lib/extraction-context\";\nimport { PipelineTracker } from \"@/components/PipelineTracker\";\nimport { describeSourceLabel, inferSourceType, pickString } from \"@/lib/source\";\n\nconst RULES = [\n  {\n    title: \"Whitespace normalization\",\n    description: \"Collapses redundant spaces, tabs, and line breaks to a single space.\",\n  },\n  {\n    title: \"Markup removal\",\n    description: \"Strips internal tokens (e.g. {%url%}, sosumi, wj markers) from copy blocks.\",\n  },\n  {\n    title: \"Locale-aware punctuation\",\n    description: \"Replaces smart quotes, ellipsis, and em-dashes with locale-specific glyphs.\",\n  },\n  {\n    title: \"Sensitive token scrub\",\n    description: \"Masks e-mail addresses, PII placeholders, and debugging metadata.\",\n  },\n];\n\ntype Feedback = {\n  state: \"idle\" | \"loading\" | \"success\" | \"error\";\n  message?: string;\n};\n\ntype RemoteCleansedContext = {\n  metadata: CleansedContext[\"metadata\"];\n  status?: string;\n  items?: unknown[];\n  rawBody?: string;\n  fallbackReason?: string;\n};\n\nconst mapLocalContext = (local: CleansedContext | null): RemoteCleansedContext | null => {\n  if (!local) return null;\n  return {\n    metadata: local.metadata,\n    status: local.status,\n    items: local.items,\n    rawBody: local.rawBody,\n    fallbackReason: local.fallbackReason,\n  };\n};\n\nconst parseJson = async (response: Response) => {\n  const rawBody = await response.text();\n  const trimmed = rawBody.trim();\n  let body: unknown = null;\n  if (trimmed.length) {\n    try {\n      body = JSON.parse(trimmed);\n    } catch {\n      body = null;\n    }\n  }\n  const looksLikeHtml = trimmed.startsWith(\"<!DOCTYPE\") || trimmed.startsWith(\"<html\");\n  const friendlyRaw =\n    looksLikeHtml && response.status\n      ? `${response.status} ${response.statusText || \"\"}`.trim() || \"HTML response returned.\"\n      : rawBody;\n  return { body, rawBody: friendlyRaw };\n};\n\nconst deriveItems = (items?: unknown[], rawBody?: string): unknown[] => {\n  if (Array.isArray(items) && items.length) {\n    return items;\n  }\n\n  if (typeof rawBody === \"string\" && rawBody.trim()) {\n    try {\n      const parsed = JSON.parse(rawBody);\n      if (Array.isArray(parsed)) return parsed;\n      if (parsed && typeof parsed === \"object\") {\n        const source = parsed as Record<string, unknown>;\n        const candidateKeys = [\n          \"items\",\n          \"records\",\n          \"data\",\n          \"payload\",\n          \"cleansedItems\",\n          \"originalItems\",\n          \"result\",\n          \"body\",\n        ];\n        const pickArray = (record: Record<string, unknown>): unknown[] => {\n          for (const key of candidateKeys) {\n            const candidate = record[key];\n            if (Array.isArray(candidate)) {\n              return candidate as unknown[];\n            }\n            if (candidate && typeof candidate === \"object\") {\n              const nested = candidate as Record<string, unknown>;\n              if (Array.isArray(nested.items)) {\n                return nested.items as unknown[];\n              }\n            }\n          }\n          return [];\n        };\n        const derived = pickArray(source);\n        if (derived.length) {\n          return derived;\n        }\n      }\n    } catch {\n      // ignore parse errors\n    }\n  }\n\n  return [];\n};\n\nconst getFirstValue = (payload: Record<string, unknown>, keys: string[]) => {\n  for (const key of keys) {\n    const value = payload[key];\n    if (\n      value !== undefined &&\n      value !== null &&\n      !(typeof value === \"string\" && value.trim().length === 0)\n    ) {\n      return value;\n    }\n  }\n  return undefined;\n};\n\nconst formatValue = (value: unknown) => {\n  if (value === undefined) return \"—\";\n  if (value === null) return \"null\";\n  if (typeof value === \"string\") return value;\n  if (typeof value === \"number\" || typeof value === \"boolean\") return String(value);\n  return JSON.stringify(value, null, 2);\n};\n\nconst isDisplayable = (value: unknown) => {\n  if (value === undefined || value === null) return false;\n  if (typeof value === \"string\") return value.trim().length > 0;\n  if (typeof value === \"number\" || typeof value === \"boolean\") return true;\n  return false;\n};\n\nconst extractStringKey = (value?: string | null) => {\n  if (!value) return undefined;\n  return value\n    .replace(/^.*::ref::/, \"\")\n    .split(\".\")\n    .pop()\n    ?.replace(/\\[[0-9]+\\]/g, \"\")\n    .trim();\n};\n\nconst pickValueFromPayload = (\n  payload: Record<string, unknown>,\n  preferredKeys: string[],\n  explicitKey?: string | null,\n): unknown => {\n  const normalizedKey = extractStringKey(explicitKey);\n  const searchKeys = [\n    normalizedKey,\n    ...preferredKeys,\n    ...FALLBACK_VALUE_KEYS,\n  ].filter((key): key is string => Boolean(key));\n\n  const candidateSources: Array<Record<string, unknown>> = [payload];\n  if (payload.context && typeof payload.context === \"object\") {\n    candidateSources.push(payload.context as Record<string, unknown>);\n    const facets = (payload.context as Record<string, unknown>).facets;\n    if (facets && typeof facets === \"object\") {\n      candidateSources.push(facets as Record<string, unknown>);\n    }\n  }\n  if (payload.facets && typeof payload.facets === \"object\") {\n    candidateSources.push(payload.facets as Record<string, unknown>);\n  }\n\n  for (const source of candidateSources) {\n    for (const key of searchKeys) {\n      const candidate = source[key];\n      if (\n        isDisplayable(candidate) &&\n        !(typeof candidate === \"string\" && candidate.trim() === key.trim())\n      ) {\n        return candidate;\n      }\n    }\n  }\n\n  return undefined;\n};\n\nconst normalizeLabel = (rawLabel: string | undefined, fallback: string): string => {\n  if (!rawLabel) return fallback;\n  const withoutRef = rawLabel.split(\"::ref::\").pop()?.trim() ?? rawLabel;\n  const cleaned = withoutRef.replace(/\\s+/g, \" \").trim();\n  const segments = cleaned.split(/[./]/).filter(Boolean);\n  const candidate = segments[segments.length - 1] ?? cleaned;\n  const withoutIndex = candidate.replace(/\\[[0-9]+\\]/g, \"\");\n  return withoutIndex || fallback;\n};\n\nconst VALUE_LABEL_KEYS = [\n  \"originalFieldName\",\n  \"fieldName\",\n  \"field\",\n  \"label\",\n  \"key\",\n  \"name\",\n  \"itemType\",\n];\nconst ORIGINAL_VALUE_KEYS = [\n  \"originalValue\",\n  \"rawValue\",\n  \"sourceValue\",\n  \"before\",\n  \"input\",\n  \"valueBefore\",\n  \"value\",\n  \"copy\",\n  \"text\",\n  \"content\",\n];\nconst CLEANSED_VALUE_KEYS = [\n  \"cleansedValue\",\n  \"cleanedValue\",\n  \"normalizedValue\",\n  \"after\",\n  \"output\",\n  \"valueAfter\",\n  \"value\",\n  \"cleansedCopy\",\n  \"cleansedContent\",\n  \"text\",\n];\nconst FALLBACK_VALUE_KEYS = [\"copy\", \"text\", \"value\", \"content\", \"body\", \"stringValue\"];\n\nconst pickNumber = (value: unknown) => {\n  if (typeof value === \"number\" && Number.isFinite(value)) {\n    return value;\n  }\n  return undefined;\n};\n\nconst buildDefaultMetadata = (\n  id: string,\n  fallback?: CleansedContext[\"metadata\"],\n): CleansedContext[\"metadata\"] => {\n  return (\n    fallback ?? {\n      name: \"Unknown dataset\",\n      size: 0,\n      source: \"Unknown source\",\n      uploadedAt: Date.now(),\n      cleansedId: id,\n    }\n  );\n};\n\nconst buildMetadataFromBackend = (\n  backend: Record<string, unknown> | null,\n  fallback: CleansedContext[\"metadata\"],\n  id: string,\n): CleansedContext[\"metadata\"] => {\n  if (!backend) return fallback;\n  const metadataRecord =\n    backend.metadata && typeof backend.metadata === \"object\"\n      ? (backend.metadata as Record<string, unknown>)\n      : null;\n\n  const next: CleansedContext[\"metadata\"] = { ...fallback };\n\n  if (metadataRecord) {\n    next.name = pickString(metadataRecord.name) ?? next.name;\n    next.source = pickString(metadataRecord.source) ?? next.source;\n    next.cleansedId = pickString(metadataRecord.cleansedId) ?? next.cleansedId;\n    next.status = pickString(metadataRecord.status) ?? next.status;\n    next.sourceIdentifier =\n      pickString(metadataRecord.sourceIdentifier) ?? next.sourceIdentifier;\n    next.sourceType = pickString(metadataRecord.sourceType) ?? next.sourceType;\n    const uploadedAtCandidate = pickNumber(metadataRecord.uploadedAt);\n    if (uploadedAtCandidate) {\n      next.uploadedAt = uploadedAtCandidate;\n    }\n    const sizeCandidate = pickNumber(metadataRecord.size);\n    if (sizeCandidate !== undefined) {\n      next.size = sizeCandidate;\n    }\n  }\n\n  const derivedIdentifier =\n    pickString(backend.sourceIdentifier) ??\n    pickString(backend.sourceUri) ??\n    next.sourceIdentifier;\n  const derivedType =\n    inferSourceType(\n      pickString(backend.sourceType),\n      derivedIdentifier ?? next.sourceIdentifier,\n      next.sourceType,\n    ) ?? next.sourceType;\n\n  next.sourceIdentifier = derivedIdentifier ?? next.sourceIdentifier;\n  next.sourceType = derivedType;\n  next.source = describeSourceLabel(derivedType, next.source);\n  next.cleansedId =\n    pickString(backend.cleansedId) ??\n    pickString(backend.cleansedDataStoreId) ??\n    next.cleansedId ??\n    id;\n\n  return next;\n};\n\nconst FeedbackPill = ({ feedback }: { feedback: Feedback }) => {\n  if (feedback.state === \"idle\") return null;\n  const base =\n    feedback.state === \"loading\"\n      ? \"bg-indigo-50 text-indigo-600\"\n      : feedback.state === \"success\"\n        ? \"bg-emerald-50 text-emerald-700\"\n        : \"bg-rose-50 text-rose-700\";\n\n  return (\n    <div className={`inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold ${base}`}>\n      {feedback.state === \"loading\"\n        ? \"Triggering enrichment…\"\n        : feedback.message ?? (feedback.state === \"success\" ? \"Enrichment triggered.\" : \"Something went wrong.\")}\n    </div>\n  );\n};\n\nexport default function CleansingPage() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const queryId = searchParams.get(\"id\");\n  const localSnapshot = mapLocalContext(loadCleansedContext());\n\n  const [context, setContext] = useState<RemoteCleansedContext | null>(localSnapshot);\n  const [items, setItems] = useState<unknown[]>(deriveItems(localSnapshot?.items, localSnapshot?.rawBody));\n  const [loading, setLoading] = useState<boolean>(!localSnapshot);\n  const [error, setError] = useState<string | null>(null);\n  const [enrichmentFeedback, setEnrichmentFeedback] = useState<Feedback>({ state: \"idle\" });\n  const [itemsLoading, setItemsLoading] = useState(false);\n  const [itemsError, setItemsError] = useState<string | null>(null);\n  const [activeId, setActiveId] = useState<string | null>(null);\n  const [hydrated, setHydrated] = useState(false);\n\n  useEffect(() => {\n    setHydrated(true);\n  }, []);\n\n  useEffect(() => {\n    const fallbackId = localSnapshot?.metadata.cleansedId ?? null;\n    setActiveId(queryId ?? fallbackId);\n  }, [queryId, localSnapshot?.metadata.cleansedId]);\n\n  const fetchItems = async (id: string, options: { showSpinner?: boolean } = {}) => {\n    const { showSpinner = true } = options;\n    if (showSpinner) {\n      setItemsLoading(true);\n    }\n    setItemsError(null);\n    try {\n      const response = await fetch(`/api/ingestion/cleansed-items?id=${encodeURIComponent(id)}`);\n      const { body, rawBody } = await parseJson(response);\n      if (!response.ok) {\n        if (response.status === 404) {\n          setItems([]);\n          setItemsError(\"Cleansed rows are not available yet.\");\n          return;\n        }\n        throw new Error(\n          (body as Record<string, unknown>)?.error as string ??\n            rawBody ??\n            \"Backend rejected the items request.\",\n        );\n      }\n      const payloadRecord = (body as Record<string, unknown>) ?? {};\n      const candidateKeys = [\n        \"items\",\n        \"records\",\n        \"data\",\n        \"payload\",\n        \"cleansedItems\",\n        \"result\",\n        \"body\",\n      ];\n      const pickArrayFromRecord = (record: Record<string, unknown>): unknown[] => {\n        for (const key of candidateKeys) {\n          const candidate = record[key];\n          if (Array.isArray(candidate)) {\n            return candidate as unknown[];\n          }\n          if (candidate && typeof candidate === \"object\" && Array.isArray((candidate as any).items)) {\n            return (candidate as any).items as unknown[];\n          }\n        }\n        return [];\n      };\n      let normalized = pickArrayFromRecord(payloadRecord);\n      if (!normalized.length && typeof payloadRecord.body === \"object\" && payloadRecord.body) {\n        normalized = pickArrayFromRecord(payloadRecord.body as Record<string, unknown>);\n      }\n      setItems(normalized);\n      setContext((previous) =>\n        previous\n          ? {\n              ...previous,\n              items: normalized,\n              rawBody:\n                typeof (body as Record<string, unknown>)?.rawBody === \"string\"\n                  ? ((body as Record<string, unknown>).rawBody as string)\n                  : previous.rawBody,\n            }\n          : previous,\n      );\n    } catch (itemsErr) {\n      setItemsError(itemsErr instanceof Error ? itemsErr.message : \"Unable to fetch cleansed items.\");\n    } finally {\n      if (showSpinner) {\n        setItemsLoading(false);\n      }\n    }\n  };\n\n  useEffect(() => {\n    const fetchContext = async (id: string | null) => {\n      if (!id) {\n        setLoading(false);\n        setError(\"Provide a cleansed ID via the URL or trigger a new run.\");\n        setContext(localSnapshot);\n        setItems(deriveItems(localSnapshot?.items, localSnapshot?.rawBody));\n        return;\n      }\n      setLoading(true);\n      setError(null);\n      try {\n        const response = await fetch(`/api/ingestion/cleansed-context?id=${encodeURIComponent(id)}`);\n        const { body, rawBody } = await parseJson(response);\n        if (!response.ok) {\n          throw new Error(\n            (body as Record<string, unknown>)?.error as string ??\n              rawBody ??\n              \"Backend rejected the cleansed context request.\",\n          );\n        }\n        const proxyPayload = (body as Record<string, unknown>) ?? {};\n        let backendRecord: Record<string, unknown> | null = null;\n        if (proxyPayload.body && typeof proxyPayload.body === \"object\") {\n          backendRecord = proxyPayload.body as Record<string, unknown>;\n        } else if (!(\"body\" in proxyPayload) && typeof proxyPayload === \"object\") {\n          backendRecord = proxyPayload;\n        }\n        const fallbackMetadata = buildDefaultMetadata(id, localSnapshot?.metadata ?? undefined);\n        const remoteMetadata = buildMetadataFromBackend(backendRecord, fallbackMetadata, id);\n        const proxiedRawBody =\n          pickString(proxyPayload.rawBody) ?? (typeof rawBody === \"string\" ? rawBody : undefined);\n        const remoteContext: RemoteCleansedContext = {\n          metadata: remoteMetadata,\n          status: pickString(backendRecord?.status) ?? localSnapshot?.status,\n          items: Array.isArray(backendRecord?.items)\n            ? (backendRecord?.items as unknown[])\n            : undefined,\n          rawBody: proxiedRawBody,\n          fallbackReason:\n            pickString(proxyPayload.fallbackReason) ??\n            pickString(backendRecord?.fallbackReason) ??\n            localSnapshot?.fallbackReason,\n        };\n        setContext(remoteContext);\n        const derived = deriveItems(remoteContext.items, remoteContext.rawBody);\n        setItems(derived);\n        await fetchItems(id, { showSpinner: derived.length === 0 });\n      } catch (contextError) {\n        setError(\n          contextError instanceof Error ? contextError.message : \"Unable to load cleansed context.\",\n        );\n        if (localSnapshot) {\n          setContext(localSnapshot);\n          setItems(deriveItems(localSnapshot.items, localSnapshot.rawBody));\n        } else {\n          setContext(null);\n          setItems([]);\n        }\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchContext(activeId);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [activeId]);\n\n  const previewRows = useMemo(() => {\n    return items.map((item, index) => {\n      if (typeof item === \"object\" && item !== null) {\n        const payload = item as Record<string, unknown>;\n        const rawLabel =\n          (payload.originalFieldName as string | undefined) ??\n          (payload.fieldName as string | undefined) ??\n          (payload.field as string | undefined) ??\n          (payload.label as string | undefined) ??\n          (payload.itemType as string | undefined);\n        const derivedLabel = normalizeLabel(rawLabel, `Item ${index + 1}`);\n        const originalCandidate =\n          pickValueFromPayload(payload, ORIGINAL_VALUE_KEYS, rawLabel) ??\n          pickValueFromPayload(\n            (payload.context as Record<string, unknown>) ?? {},\n            ORIGINAL_VALUE_KEYS,\n            rawLabel,\n          );\n        const cleansedCandidate =\n          pickValueFromPayload(payload, CLEANSED_VALUE_KEYS, rawLabel) ??\n          pickValueFromPayload(\n            (payload.context as Record<string, unknown>) ?? {},\n            CLEANSED_VALUE_KEYS,\n            rawLabel,\n          );\n        return {\n          id: payload.id ?? `${derivedLabel}-${index}`,\n          label: derivedLabel,\n          original: formatValue(originalCandidate),\n          cleansed: formatValue(cleansedCandidate),\n        };\n      }\n      return {\n        id: `item-${index}`,\n        label: `Item ${index + 1}`,\n        original: formatValue(item),\n        cleansed: formatValue(item),\n      };\n    });\n  }, [items]);\n\n  const handleSendToEnrichment = async () => {\n    if (!context?.metadata.cleansedId) {\n      setEnrichmentFeedback({\n        state: \"error\",\n        message: \"Cleansed ID is missing. Re-run extraction before enrichment.\",\n      });\n      return;\n    }\n\n    setEnrichmentFeedback({ state: \"loading\", message: \"Triggering enrichment…\" });\n    try {\n      const response = await fetch(\"/api/ingestion/enrichment\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ id: context.metadata.cleansedId }),\n      });\n      const payload = await response.json();\n\n      if (!response.ok) {\n        setEnrichmentFeedback({\n          state: \"error\",\n          message: payload?.error ?? \"Backend rejected the request.\",\n        });\n        return;\n      }\n\n      const now = Date.now();\n      saveEnrichmentContext({\n        metadata: context.metadata,\n        startedAt: now,\n        statusHistory: [\n          { status: \"ENRICHMENT_TRIGGERED\", timestamp: now },\n          {\n            status:\n              typeof payload?.body?.status === \"string\"\n                ? payload.body.status\n                : \"WAITING_FOR_RESULTS\",\n            timestamp: now,\n          },\n        ],\n      });\n\n      setEnrichmentFeedback({\n        state: \"success\",\n        message: \"Enrichment pipeline triggered.\",\n      });\n      router.push(`/enrichment?id=${encodeURIComponent(context.metadata.cleansedId)}`);\n    } catch (error) {\n      setEnrichmentFeedback({\n        state: \"error\",\n        message:\n          error instanceof Error ? error.message : \"Unable to reach enrichment service.\",\n      });\n    }\n  };\n\n  if (loading || !hydrated) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-slate-50 px-6 py-16\">\n        <div className=\"max-w-lg rounded-3xl border border-slate-200 bg-white p-10 text-center shadow-sm\">\n          <p className=\"text-xs uppercase tracking-wide text-slate-400\">Cleansing</p>\n          <h1 className=\"mt-2 text-2xl font-semibold text-slate-900\">Loading context…</h1>\n          <p className=\"mt-3 text-sm text-slate-500\">\n            Fetching cleansed snapshot from the backend. One moment please.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!context) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-slate-50 px-6 py-16\">\n        <div className=\"max-w-lg rounded-3xl border border-slate-200 bg-white p-10 text-center shadow-sm\">\n          <p className=\"text-xs uppercase tracking-wide text-slate-400\">Cleansing</p>\n          <h1 className=\"mt-2 text-2xl font-semibold text-slate-900\">\n            {error ?? \"Cleansed context not found\"}\n          </h1>\n          <p className=\"mt-3 text-sm text-slate-500\">\n            Provide a valid `id` query parameter or trigger the pipeline again.\n          </p>\n          <button\n            type=\"button\"\n            onClick={() => router.push(\"/extraction\")}\n            className=\"mt-6 rounded-full bg-slate-900 px-6 py-2 text-sm font-semibold text-white\"\n          >\n            Back to Extraction\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  const sourceLabel = describeSourceLabel(\n    context.metadata.sourceType ?? context.metadata.source,\n    context.metadata.source,\n  );\n  const sourceIdentifier = context.metadata.sourceIdentifier ?? \"—\";\n\n  return (\n    <div className=\"min-h-screen bg-slate-50\">\n      <header className=\"border-b border-slate-200 bg-white\">\n        <div className=\"mx-auto flex max-w-6xl flex-col gap-4 px-6 py-4 md:flex-row md:items-center md:justify-between\">\n          <div>\n            <p className=\"text-xs uppercase tracking-wide text-slate-400\">Cleansing</p>\n            <h1 className=\"text-xl font-semibold text-slate-900\">\n              Review cleansed output ({context.metadata.name})\n            </h1>\n          </div>\n          <div className=\"flex flex-1 flex-col items-start gap-3 md:flex-row md:items-center md:justify-end\">\n            <PipelineTracker current=\"cleansing\" />\n            <FeedbackPill feedback={enrichmentFeedback} />\n          </div>\n        </div>\n      </header>\n\n      <main className=\"mx-auto flex max-w-6xl flex-col gap-6 px-6 py-8\">\n        <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm\">\n          <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n            <div>\n              <p className=\"text-xs uppercase tracking-wide text-slate-400\">Status</p>\n              <h2 className=\"text-lg font-semibold text-slate-900\">\n                {context.status ?? \"Pending\"}\n              </h2>\n            </div>\n            <div className=\"text-xs text-slate-500\">\n              <p>Uploaded</p>\n              <p className=\"font-semibold text-slate-800\">\n                {new Date(context.metadata.uploadedAt).toLocaleString()}\n              </p>\n            </div>\n          </div>\n          <div className=\"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\n            <div>\n              <dt className=\"text-xs uppercase tracking-wide text-slate-400\">\n                Cleansed ID\n              </dt>\n              <dd className=\"text-sm font-semibold text-slate-900\">\n                {context.metadata.cleansedId ?? \"—\"}\n              </dd>\n            </div>\n            <div>\n              <dt className=\"text-xs uppercase tracking-wide text-slate-400\">Source</dt>\n              <dd className=\"text-sm font-semibold text-slate-900\">{sourceLabel}</dd>\n            </div>\n            <div>\n              <dt className=\"text-xs uppercase tracking-wide text-slate-400\">Source identifier</dt>\n              <dd className=\"text-sm font-semibold text-slate-900 break-all\">\n                {sourceIdentifier}\n              </dd>\n            </div>\n            <div>\n              <dt className=\"text-xs uppercase tracking-wide text-slate-400\">Cache status</dt>\n              <dd className=\"text-sm font-semibold text-slate-900\">\n                {context.fallbackReason === \"quota\" ? \"Partial snapshot\" : \"Complete snapshot\"}\n              </dd>\n            </div>\n          </div>\n        </section>\n\n        <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm\">\n          <div className=\"flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between\">\n            <div>\n              <p className=\"text-xs uppercase tracking-wide text-slate-400\">Items</p>\n              <h2 className=\"text-lg font-semibold text-slate-900\">\n                Original vs Cleansed values\n              </h2>\n            </div>\n          </div>\n\n          {itemsLoading ? (\n            <div className=\"mt-4 rounded-2xl border border-slate-200 bg-slate-50 py-10 text-center text-sm text-slate-600\">\n              Fetching latest cleansed rows…\n            </div>\n          ) : itemsError ? (\n            <div className=\"mt-4 rounded-2xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900\">\n              <p className=\"font-semibold\">Unable to load cleansed items.</p>\n              <p className=\"mt-1\">{itemsError}</p>\n              <button\n                type=\"button\"\n                onClick={() => context.metadata.cleansedId && fetchItems(context.metadata.cleansedId)}\n                className=\"mt-3 rounded-full bg-amber-600 px-3 py-1 text-xs font-semibold text-white\"\n              >\n                Retry fetch\n              </button>\n            </div>\n          ) : previewRows.length === 0 ? (\n            <div className=\"mt-4 rounded-2xl border border-dashed border-slate-200 py-10 text-center text-sm text-slate-500\">\n              No cleansed items available yet.\n            </div>\n          ) : (\n            <div className=\"mt-4 rounded-2xl border border-slate-100\">\n              <div className=\"max-h-[480px] overflow-y-auto\">\n              <table className=\"w-full text-left text-sm\">\n                <thead className=\"bg-slate-50 text-xs uppercase tracking-wide text-slate-500\">\n                  <tr>\n                    <th className=\"px-4 py-3 font-semibold\">Field</th>\n                    <th className=\"px-4 py-3 font-semibold\">Original value</th>\n                    <th className=\"px-4 py-3 font-semibold\">Cleansed value</th>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-slate-100 bg-white\">\n                  {previewRows.map((row) => (\n                    <tr key={row.id}>\n                      <td className=\"px-4 py-3 align-top font-semibold text-slate-900\">\n                        {row.label}\n                      </td>\n                      <td className=\"px-4 py-3 align-top text-slate-700\">\n                        <pre className=\"whitespace-pre-wrap text-xs\">{row.original}</pre>\n                      </td>\n                      <td className=\"px-4 py-3 align-top text-slate-700\">\n                        <pre className=\"whitespace-pre-wrap text-xs\">{row.cleansed}</pre>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n              </div>\n            </div>\n          )}\n        </section>\n\n        <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm\">\n          <div className=\"flex flex-col gap-3\">\n            <div>\n              <p className=\"text-xs uppercase tracking-wide text-slate-400\">Applied rules</p>\n              <h2 className=\"text-lg font-semibold text-slate-900\">\n                Cleansing heuristics snapshot\n              </h2>\n            </div>\n            <div className=\"grid gap-4 md:grid-cols-2\">\n              {RULES.map((rule) => (\n                <div\n                  key={rule.title}\n                  className=\"rounded-2xl border border-slate-100 bg-slate-50 p-4 shadow-inner\"\n                >\n                  <p className=\"text-sm font-semibold text-slate-900\">{rule.title}</p>\n                  <p className=\"mt-1 text-xs text-slate-600\">{rule.description}</p>\n                </div>\n              ))}\n            </div>\n          </div>\n        </section>\n\n        <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm\">\n          <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n            <div>\n              <p className=\"text-xs uppercase tracking-wide text-slate-400\">Next steps</p>\n              <h2 className=\"text-lg font-semibold text-slate-900\">\n                Ready to send for enrichment?\n              </h2>\n            </div>\n            <div className=\"flex flex-wrap gap-2\">\n              <button\n                type=\"button\"\n                onClick={() => router.push(\"/extraction\")}\n                className=\"rounded-full border border-slate-300 px-4 py-2 text-xs font-semibold text-slate-700\"\n              >\n                Back to Extraction\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleSendToEnrichment}\n                disabled={enrichmentFeedback.state === \"loading\"}\n                className=\"rounded-full bg-slate-900 px-4 py-2 text-xs font-semibold text-white disabled:cursor-not-allowed disabled:opacity-70\"\n              >\n                {enrichmentFeedback.state === \"loading\"\n                  ? \"Sending to Enrichment…\"\n                  : \"Send to Enrichment\"}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  clearCleansedContext();\n                  router.push(\"/ingestion\");\n                }}\n                className=\"rounded-full border border-slate-300 px-4 py-2 text-xs font-semibold text-slate-700\"\n              >\n                Start Over\n              </button>\n            </div>\n          </div>\n        </section>\n      </main>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}