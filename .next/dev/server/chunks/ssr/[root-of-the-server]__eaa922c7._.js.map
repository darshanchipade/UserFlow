{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/lib/tree.ts"],"sourcesContent":["export type TreeNode = {\n  id: string;\n  label: string;\n  path: string;\n  type: \"object\" | \"array\" | \"value\";\n  children?: TreeNode[];\n  value?: unknown;\n};\n\nconst MAX_TREE_NODES = 5000;\nconst MAX_ARRAY_CHILDREN = 100;\n\nconst isPlainObject = (value: unknown): value is Record<string, unknown> =>\n  typeof value === \"object\" && value !== null && !Array.isArray(value);\n\nexport const buildTreeFromJson = (\n  payload: unknown,\n  parentPath: string[] = [],\n  counter: { value: number } = { value: 0 },\n): TreeNode[] => {\n  if (counter.value >= MAX_TREE_NODES) return [];\n\n  if (Array.isArray(payload)) {\n    return payload.slice(0, MAX_ARRAY_CHILDREN).flatMap((entry, index) => {\n      const label = `[${index}]`;\n      const id = [...parentPath, label].join(\".\");\n      counter.value += 1;\n      if (counter.value >= MAX_TREE_NODES) return [];\n\n      const childNodes = buildTreeFromJson(entry, [...parentPath, label], counter);\n      return [\n        {\n          id,\n          label,\n          path: id,\n          type: Array.isArray(entry)\n            ? \"array\"\n            : isPlainObject(entry)\n              ? \"object\"\n              : \"value\",\n          children: childNodes.length ? childNodes : undefined,\n          value:\n            !Array.isArray(entry) && !isPlainObject(entry)\n              ? entry\n              : childNodes.length === 0\n                ? entry\n                : undefined,\n        },\n      ];\n    });\n  }\n\n  if (isPlainObject(payload)) {\n    return Object.entries(payload).flatMap(([key, value]) => {\n      if (counter.value >= MAX_TREE_NODES) return [];\n      const id = [...parentPath, key].join(\".\");\n      counter.value += 1;\n      const childNodes = buildTreeFromJson(value, [...parentPath, key], counter);\n      return [\n        {\n          id,\n          label: key,\n          path: id,\n          type: Array.isArray(value)\n            ? \"array\"\n            : isPlainObject(value)\n              ? \"object\"\n              : \"value\",\n          children: childNodes.length ? childNodes : undefined,\n          value:\n            !Array.isArray(value) && !isPlainObject(value)\n              ? value\n              : childNodes.length === 0\n                ? value\n                : undefined,\n        },\n      ];\n    });\n  }\n\n  return [];\n};\n\nexport const gatherLeafNodes = (node: TreeNode): TreeNode[] => {\n  if (!node.children || node.children.length === 0) {\n    return [node];\n  }\n  return node.children.flatMap((child) => gatherLeafNodes(child));\n};\n\nexport const gatherNodeIds = (node: TreeNode): string[] => {\n  return [\n    node.id,\n    ...(node.children?.flatMap((child) => gatherNodeIds(child)) ?? []),\n  ];\n};\n\nexport const filterTree = (nodes: TreeNode[], query: string): TreeNode[] => {\n  if (!query) return nodes;\n  const normalized = query.toLowerCase();\n\n  const searchNode = (node: TreeNode): TreeNode | null => {\n    const matches = node.label.toLowerCase().includes(normalized);\n    if (!node.children || node.children.length === 0) {\n      return matches ? node : null;\n    }\n    const filteredChildren = node.children\n      .map(searchNode)\n      .filter((child): child is TreeNode => Boolean(child));\n    if (matches || filteredChildren.length > 0) {\n      return {\n        ...node,\n        children: filteredChildren.length ? filteredChildren : undefined,\n      };\n    }\n    return null;\n  };\n\n  return nodes\n    .map(searchNode)\n    .filter((node): node is TreeNode => Boolean(node));\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/lib/extraction-context.ts"],"sourcesContent":["import { TreeNode } from \"./tree\";\n\nexport type ExtractionContext = {\n  mode: \"local\" | \"api\" | \"s3\";\n  metadata: {\n    name: string;\n    size: number;\n    source: string;\n    cleansedId?: string;\n    status?: string;\n    uploadedAt: number;\n    sourceIdentifier?: string;\n    sourceType?: string;\n  };\n  sourceUri?: string;\n  snapshotId?: string;\n  /**\n   * @deprecated Legacy fields retained for backwards compatibility.\n   */\n  tree?: TreeNode[];\n  rawJson?: string;\n  backendPayload?: unknown;\n};\n\nexport type PersistenceFailureReason = \"ssr\" | \"quota\" | \"unknown\";\n\nexport type PersistenceResult = {\n  ok: boolean;\n  reason?: PersistenceFailureReason;\n  usedFallback?: boolean;\n};\n\nconst STORAGE_KEY = \"extraction-context\";\nconst CLEANSED_STORAGE_KEY = \"cleansed-context\";\nconst ENRICHMENT_STORAGE_KEY = \"enrichment-context\";\n\nconst MAX_CLEANSED_ITEMS = 150;\nconst MAX_CLEANSED_RAW_BODY_CHARS = 200_000;\n\nconst isQuotaExceededError = (error: unknown): error is DOMException => {\n  if (typeof DOMException === \"undefined\") return false;\n\n  return (\n    error instanceof DOMException &&\n    (error.name === \"QuotaExceededError\" ||\n      error.name === \"NS_ERROR_DOM_QUOTA_REACHED\" ||\n      error.code === 22 ||\n      error.code === 1014)\n  );\n};\n\nconst MAX_EXTRACTION_RAW_BODY_CHARS = 500_000;\n\nconst persistToSessionStorage = (key: string, payload: unknown): PersistenceResult => {\n  if (typeof window === \"undefined\") {\n    return { ok: false, reason: \"ssr\" };\n  }\n\n  try {\n    sessionStorage.setItem(key, JSON.stringify(payload));\n    return { ok: true };\n  } catch (error) {\n    if (isQuotaExceededError(error)) {\n      console.warn(`Session storage quota exceeded while saving '${key}'.`);\n      return { ok: false, reason: \"quota\" };\n    }\n\n    console.error(`Failed to persist '${key}' to sessionStorage`, error);\n    return { ok: false, reason: \"unknown\" };\n  }\n};\n\nconst safeLoad = <T>(serialized: string | null): T | null => {\n  if (!serialized) return null;\n\n  try {\n    return JSON.parse(serialized) as T;\n  } catch (error) {\n    console.error(\"Failed to parse session storage payload\", error);\n    return null;\n  }\n};\n\nconst sanitizeExtractionContext = (payload: ExtractionContext): ExtractionContext => {\n  const next: ExtractionContext = {\n    ...payload,\n    backendPayload: undefined,\n  };\n\n  if (typeof next.rawJson === \"string\" && next.rawJson.length > MAX_EXTRACTION_RAW_BODY_CHARS) {\n    next.rawJson = next.rawJson.slice(0, MAX_EXTRACTION_RAW_BODY_CHARS);\n  }\n\n  return next;\n};\n\nexport const saveExtractionContext = (payload: ExtractionContext) => {\n  const sanitized = sanitizeExtractionContext(payload);\n  return persistToSessionStorage(STORAGE_KEY, sanitized);\n};\n\nexport const loadExtractionContext = (): ExtractionContext | null => {\n  if (typeof window === \"undefined\") return null;\n  const stored = sessionStorage.getItem(STORAGE_KEY);\n  return safeLoad<ExtractionContext>(stored);\n};\n\nexport const clearExtractionContext = () => {\n  if (typeof window === \"undefined\") return;\n  sessionStorage.removeItem(STORAGE_KEY);\n};\n\nexport type CleansedContext = {\n  metadata: ExtractionContext[\"metadata\"];\n  items: unknown[];\n  rawBody?: string;\n  status?: string;\n  itemsTruncated?: boolean;\n  rawBodyTruncated?: boolean;\n  fallbackReason?: PersistenceFailureReason;\n};\n\nconst sanitizeCleansedPayload = (payload: CleansedContext): CleansedContext => {\n  const next: CleansedContext = {\n    ...payload,\n    items: Array.isArray(payload.items) ? [...payload.items] : [],\n  };\n\n  if (next.items.length > MAX_CLEANSED_ITEMS) {\n    next.items = next.items.slice(0, MAX_CLEANSED_ITEMS);\n    next.itemsTruncated = true;\n  }\n\n  if (typeof next.rawBody === \"string\" && next.rawBody.length > MAX_CLEANSED_RAW_BODY_CHARS) {\n    next.rawBody = next.rawBody.slice(0, MAX_CLEANSED_RAW_BODY_CHARS);\n    next.rawBodyTruncated = true;\n  }\n\n  return next;\n};\n\nexport const saveCleansedContext = (payload: CleansedContext): PersistenceResult => {\n  const sanitized = sanitizeCleansedPayload(payload);\n  const result = persistToSessionStorage(CLEANSED_STORAGE_KEY, sanitized);\n\n  if (!result.ok && result.reason === \"quota\") {\n    const fallbackPayload: CleansedContext = {\n      metadata: sanitized.metadata,\n      status: sanitized.status,\n      items: [],\n      fallbackReason: \"quota\",\n    };\n    const fallbackResult = persistToSessionStorage(CLEANSED_STORAGE_KEY, fallbackPayload);\n    if (fallbackResult.ok) {\n      return {\n        ok: true,\n        reason: \"quota\",\n        usedFallback: true,\n      };\n    }\n    return fallbackResult;\n  }\n\n  return result;\n};\n\nexport const loadCleansedContext = (): CleansedContext | null => {\n  if (typeof window === \"undefined\") return null;\n  const stored = sessionStorage.getItem(CLEANSED_STORAGE_KEY);\n  return safeLoad<CleansedContext>(stored);\n};\n\nexport const clearCleansedContext = () => {\n  if (typeof window === \"undefined\") return;\n  sessionStorage.removeItem(CLEANSED_STORAGE_KEY);\n};\n\nexport type EnrichmentStatusEntry = {\n  status: string;\n  timestamp: number;\n};\n\nexport type EnrichmentContext = {\n  metadata: ExtractionContext[\"metadata\"];\n  items?: unknown[];\n  startedAt: number;\n  statusHistory: EnrichmentStatusEntry[];\n};\n\nexport const saveEnrichmentContext = (payload: EnrichmentContext) => {\n  return persistToSessionStorage(ENRICHMENT_STORAGE_KEY, payload);\n};\n\nexport const loadEnrichmentContext = (): EnrichmentContext | null => {\n  if (typeof window === \"undefined\") return null;\n  const stored = sessionStorage.getItem(ENRICHMENT_STORAGE_KEY);\n  return safeLoad<EnrichmentContext>(stored);\n};\n\nexport const clearEnrichmentContext = () => {\n  if (typeof window === \"undefined\") return;\n  sessionStorage.removeItem(ENRICHMENT_STORAGE_KEY);\n};"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAgCA,MAAM,cAAc;AACpB,MAAM,uBAAuB;AAC7B,MAAM,yBAAyB;AAE/B,MAAM,qBAAqB;AAC3B,MAAM,8BAA8B;AAEpC,MAAM,uBAAuB,CAAC;IAC5B,IAAI,OAAO,iBAAiB,aAAa,OAAO;IAEhD,OACE,iBAAiB,gBACjB,CAAC,MAAM,IAAI,KAAK,wBACd,MAAM,IAAI,KAAK,gCACf,MAAM,IAAI,KAAK,MACf,MAAM,IAAI,KAAK,IAAI;AAEzB;AAEA,MAAM,gCAAgC;AAEtC,MAAM,0BAA0B,CAAC,KAAa;IAC5C,wCAAmC;QACjC,OAAO;YAAE,IAAI;YAAO,QAAQ;QAAM;IACpC;;;AAcF;AAEA,MAAM,WAAW,CAAI;IACnB,IAAI,CAAC,YAAY,OAAO;IAExB,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2CAA2C;QACzD,OAAO;IACT;AACF;AAEA,MAAM,4BAA4B,CAAC;IACjC,MAAM,OAA0B;QAC9B,GAAG,OAAO;QACV,gBAAgB;IAClB;IAEA,IAAI,OAAO,KAAK,OAAO,KAAK,YAAY,KAAK,OAAO,CAAC,MAAM,GAAG,+BAA+B;QAC3F,KAAK,OAAO,GAAG,KAAK,OAAO,CAAC,KAAK,CAAC,GAAG;IACvC;IAEA,OAAO;AACT;AAEO,MAAM,wBAAwB,CAAC;IACpC,MAAM,YAAY,0BAA0B;IAC5C,OAAO,wBAAwB,aAAa;AAC9C;AAEO,MAAM,wBAAwB;IACnC,wCAAmC,OAAO;;;IAC1C,MAAM;AAER;AAEO,MAAM,yBAAyB;IACpC,wCAAmC;;;AAErC;AAYA,MAAM,0BAA0B,CAAC;IAC/B,MAAM,OAAwB;QAC5B,GAAG,OAAO;QACV,OAAO,MAAM,OAAO,CAAC,QAAQ,KAAK,IAAI;eAAI,QAAQ,KAAK;SAAC,GAAG,EAAE;IAC/D;IAEA,IAAI,KAAK,KAAK,CAAC,MAAM,GAAG,oBAAoB;QAC1C,KAAK,KAAK,GAAG,KAAK,KAAK,CAAC,KAAK,CAAC,GAAG;QACjC,KAAK,cAAc,GAAG;IACxB;IAEA,IAAI,OAAO,KAAK,OAAO,KAAK,YAAY,KAAK,OAAO,CAAC,MAAM,GAAG,6BAA6B;QACzF,KAAK,OAAO,GAAG,KAAK,OAAO,CAAC,KAAK,CAAC,GAAG;QACrC,KAAK,gBAAgB,GAAG;IAC1B;IAEA,OAAO;AACT;AAEO,MAAM,sBAAsB,CAAC;IAClC,MAAM,YAAY,wBAAwB;IAC1C,MAAM,SAAS,wBAAwB,sBAAsB;IAE7D,IAAI,CAAC,OAAO,EAAE,IAAI,OAAO,MAAM,KAAK,SAAS;QAC3C,MAAM,kBAAmC;YACvC,UAAU,UAAU,QAAQ;YAC5B,QAAQ,UAAU,MAAM;YACxB,OAAO,EAAE;YACT,gBAAgB;QAClB;QACA,MAAM,iBAAiB,wBAAwB,sBAAsB;QACrE,IAAI,eAAe,EAAE,EAAE;YACrB,OAAO;gBACL,IAAI;gBACJ,QAAQ;gBACR,cAAc;YAChB;QACF;QACA,OAAO;IACT;IAEA,OAAO;AACT;AAEO,MAAM,sBAAsB;IACjC,wCAAmC,OAAO;;;IAC1C,MAAM;AAER;AAEO,MAAM,uBAAuB;IAClC,wCAAmC;;;AAErC;AAcO,MAAM,wBAAwB,CAAC;IACpC,OAAO,wBAAwB,wBAAwB;AACzD;AAEO,MAAM,wBAAwB;IACnC,wCAAmC,OAAO;;;IAC1C,MAAM;AAER;AAEO,MAAM,yBAAyB;IACpC,wCAAmC;;;AAErC"}},
    {"offset": {"line": 275, "column": 0}, "map": {"version":3,"sources":["file:///Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/lib/client/snapshot-store.ts"],"sourcesContent":["\"use client\";\n\nimport type { ExtractionSnapshot } from \"@/lib/extraction-snapshot\";\n\nconst DB_NAME = \"ExtractionSnapshots\";\nconst STORE_NAME = \"snapshots\";\n\ntype SnapshotStoreResult =\n  | { ok: true }\n  | {\n      ok: false;\n      message?: string;\n    };\n\nconst openDatabase = (): Promise<IDBDatabase> => {\n  return new Promise((resolve, reject) => {\n    if (typeof window === \"undefined\" || !window.indexedDB) {\n      reject(new Error(\"IndexedDB is not available in this environment.\"));\n      return;\n    }\n\n    const request = window.indexedDB.open(DB_NAME, 1);\n\n    request.onerror = () => {\n      reject(request.error ?? new Error(\"Failed to open IndexedDB.\"));\n    };\n\n    request.onupgradeneeded = () => {\n      const db = request.result;\n      if (!db.objectStoreNames.contains(STORE_NAME)) {\n        db.createObjectStore(STORE_NAME);\n      }\n    };\n\n    request.onsuccess = () => {\n      resolve(request.result);\n    };\n  });\n};\n\nexport const storeClientSnapshot = async (\n  id: string,\n  payload: ExtractionSnapshot,\n): Promise<SnapshotStoreResult> => {\n  try {\n    const db = await openDatabase();\n    await new Promise<void>((resolve, reject) => {\n      const transaction = db.transaction(STORE_NAME, \"readwrite\");\n      const store = transaction.objectStore(STORE_NAME);\n      const request = store.put(payload, id);\n\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error ?? new Error(\"Failed to store snapshot.\"));\n    });\n    return { ok: true };\n  } catch (error) {\n    return {\n      ok: false,\n      message:\n        error instanceof Error ? error.message : \"Failed to store snapshot in IndexedDB.\",\n    };\n  }\n};\n\nexport const readClientSnapshot = async (\n  id: string,\n): Promise<ExtractionSnapshot | null> => {\n  try {\n    const db = await openDatabase();\n    return await new Promise((resolve, reject) => {\n      const transaction = db.transaction(STORE_NAME, \"readonly\");\n      const store = transaction.objectStore(STORE_NAME);\n      const request = store.get(id);\n      request.onsuccess = () => resolve((request.result as ExtractionSnapshot) ?? null);\n      request.onerror = () => reject(request.error ?? new Error(\"Failed to read snapshot.\"));\n    });\n  } catch {\n    return null;\n  }\n};\n"],"names":[],"mappings":";;;;;;AAAA;AAIA,MAAM,UAAU;AAChB,MAAM,aAAa;AASnB,MAAM,eAAe;IACnB,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,wCAAwD;YACtD,OAAO,IAAI,MAAM;YACjB;QACF;;;QAEA,MAAM;IAgBR;AACF;AAEO,MAAM,sBAAsB,OACjC,IACA;IAEA,IAAI;QACF,MAAM,KAAK,MAAM;QACjB,MAAM,IAAI,QAAc,CAAC,SAAS;YAChC,MAAM,cAAc,GAAG,WAAW,CAAC,YAAY;YAC/C,MAAM,QAAQ,YAAY,WAAW,CAAC;YACtC,MAAM,UAAU,MAAM,GAAG,CAAC,SAAS;YAEnC,QAAQ,SAAS,GAAG,IAAM;YAC1B,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK,IAAI,IAAI,MAAM;QAC5D;QACA,OAAO;YAAE,IAAI;QAAK;IACpB,EAAE,OAAO,OAAO;QACd,OAAO;YACL,IAAI;YACJ,SACE,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAC7C;IACF;AACF;AAEO,MAAM,qBAAqB,OAChC;IAEA,IAAI;QACF,MAAM,KAAK,MAAM;QACjB,OAAO,MAAM,IAAI,QAAQ,CAAC,SAAS;YACjC,MAAM,cAAc,GAAG,WAAW,CAAC,YAAY;YAC/C,MAAM,QAAQ,YAAY,WAAW,CAAC;YACtC,MAAM,UAAU,MAAM,GAAG,CAAC;YAC1B,QAAQ,SAAS,GAAG,IAAM,QAAQ,AAAC,QAAQ,MAAM,IAA2B;YAC5E,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK,IAAI,IAAI,MAAM;QAC5D;IACF,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 333, "column": 0}, "map": {"version":3,"sources":["file:///Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/lib/source.ts"],"sourcesContent":["export const pickString = (value: unknown): string | undefined => {\n  if (typeof value !== \"string\") return undefined;\n  const trimmed = value.trim();\n  return trimmed.length ? trimmed : undefined;\n};\n\nexport const inferSourceType = (\n  explicitType?: string,\n  identifier?: string,\n  fallback?: string,\n): string | undefined => {\n  const normalized = explicitType?.toLowerCase();\n  if (normalized) {\n    return normalized;\n  }\n  if (!identifier) {\n    return fallback;\n  }\n  const token = identifier.toLowerCase();\n  if (token.startsWith(\"file-upload\") || token.startsWith(\"local:\")) {\n    return \"file\";\n  }\n  if (token.startsWith(\"api-payload\") || token.includes(\"api\")) {\n    return \"api\";\n  }\n  if (token.startsWith(\"s3://\") || token.includes(\"s3\")) {\n    return \"s3\";\n  }\n  if (token.startsWith(\"classpath:\")) {\n    return \"classpath\";\n  }\n  return fallback;\n};\n\nexport const describeSourceLabel = (\n  type?: string,\n  fallback = \"Unknown source\",\n): string => {\n  if (!type) return fallback;\n  const normalized = type.toLowerCase();\n  if (normalized.includes(\"api\")) return \"API payload\";\n  if (normalized.includes(\"s3\") || normalized.includes(\"cloud\")) return \"S3 / Cloud\";\n  if (normalized.includes(\"class\")) return \"Classpath resource\";\n  if (normalized.includes(\"local\")) return \"Local upload\";\n  if (normalized.includes(\"file\")) return \"File upload\";\n  return type;\n};"],"names":[],"mappings":";;;;;;;;AAAO,MAAM,aAAa,CAAC;IACzB,IAAI,OAAO,UAAU,UAAU,OAAO;IACtC,MAAM,UAAU,MAAM,IAAI;IAC1B,OAAO,QAAQ,MAAM,GAAG,UAAU;AACpC;AAEO,MAAM,kBAAkB,CAC7B,cACA,YACA;IAEA,MAAM,aAAa,cAAc;IACjC,IAAI,YAAY;QACd,OAAO;IACT;IACA,IAAI,CAAC,YAAY;QACf,OAAO;IACT;IACA,MAAM,QAAQ,WAAW,WAAW;IACpC,IAAI,MAAM,UAAU,CAAC,kBAAkB,MAAM,UAAU,CAAC,WAAW;QACjE,OAAO;IACT;IACA,IAAI,MAAM,UAAU,CAAC,kBAAkB,MAAM,QAAQ,CAAC,QAAQ;QAC5D,OAAO;IACT;IACA,IAAI,MAAM,UAAU,CAAC,YAAY,MAAM,QAAQ,CAAC,OAAO;QACrD,OAAO;IACT;IACA,IAAI,MAAM,UAAU,CAAC,eAAe;QAClC,OAAO;IACT;IACA,OAAO;AACT;AAEO,MAAM,sBAAsB,CACjC,MACA,WAAW,gBAAgB;IAE3B,IAAI,CAAC,MAAM,OAAO;IAClB,MAAM,aAAa,KAAK,WAAW;IACnC,IAAI,WAAW,QAAQ,CAAC,QAAQ,OAAO;IACvC,IAAI,WAAW,QAAQ,CAAC,SAAS,WAAW,QAAQ,CAAC,UAAU,OAAO;IACtE,IAAI,WAAW,QAAQ,CAAC,UAAU,OAAO;IACzC,IAAI,WAAW,QAAQ,CAAC,UAAU,OAAO;IACzC,IAAI,WAAW,QAAQ,CAAC,SAAS,OAAO;IACxC,OAAO;AACT"}},
    {"offset": {"line": 383, "column": 0}, "map": {"version":3,"sources":["file:///Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/ingestion/page.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ArrowPathIcon,\n  ArrowUpTrayIcon,\n  CheckCircleIcon,\n  ChevronDownIcon,\n  ChevronRightIcon,\n  CloudArrowUpIcon,\n  DocumentTextIcon,\n  ExclamationCircleIcon,\n  InboxStackIcon,\n  MagnifyingGlassIcon,\n  ServerStackIcon,\n} from \"@heroicons/react/24/outline\";\nimport clsx from \"clsx\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport {\n  TreeNode,\n  buildTreeFromJson,\n  filterTree,\n  gatherLeafNodes,\n} from \"@/lib/tree\";\nimport {\n  saveExtractionContext,\n  type ExtractionContext,\n  type PersistenceResult,\n} from \"@/lib/extraction-context\";\nimport { storeClientSnapshot } from \"@/lib/client/snapshot-store\";\nimport type { ExtractionSnapshot } from \"@/lib/extraction-snapshot\";\nimport { describeSourceLabel, inferSourceType, pickString } from \"@/lib/source\";\n\ntype UploadTab = \"local\" | \"api\" | \"s3\";\n\ntype UploadStatus = \"uploading\" | \"success\" | \"error\";\n\ntype UploadItem = {\n  id: string;\n  name: string;\n  size: number;\n  type: string;\n  source: \"Local\" | \"API\" | \"S3\";\n  status: UploadStatus;\n  createdAt: number;\n  cleansedId?: string;\n  backendStatus?: string;\n  backendMessage?: string;\n};\n\ntype ApiFeedback = {\n  state: \"idle\" | \"loading\" | \"success\" | \"error\";\n  message?: string;\n};\n\nconst steps = [\n  { label: \"Ingestion\", status: \"current\" as const },\n  { label: \"Extraction\", status: \"upcoming\" as const },\n  { label: \"Cleansing\", status: \"upcoming\" as const },\n  { label: \"Data Enrichment\", status: \"upcoming\" as const },\n  { label: \"Content QA\", status: \"upcoming\" as const },\n];\n\nconst uploadTabs = [\n  {\n    id: \"s3\" as const,\n    title: \"Amazon S3 / Cloud\",\n    description: \"Ingest directly from s3:// or classpath URIs.\",\n    icon: CloudArrowUpIcon,\n    disabled: false,\n  },\n  {\n    id: \"local\" as const,\n    title: \"Local Upload\",\n    description: \"Upload files directly from your device.\",\n    icon: ArrowUpTrayIcon,\n    disabled: false,\n  },\n  {\n    id: \"api\" as const,\n    title: \"API Endpoint\",\n    description: \"Send JSON payloads programmatically.\",\n    icon: ServerStackIcon,\n    disabled: false,\n  },\n];\n\nconst statusStyles: Record<\n  UploadStatus,\n  { label: string; className: string; dot: string }\n> = {\n  uploading: {\n    label: \"Uploading\",\n    className: \"bg-amber-50 text-amber-700\",\n    dot: \"bg-amber-400\",\n  },\n  success: {\n    label: \"Accepted\",\n    className: \"bg-emerald-50 text-emerald-700\",\n    dot: \"bg-emerald-500\",\n  },\n  error: {\n    label: \"Error\",\n    className: \"bg-rose-50 text-rose-700\",\n    dot: \"bg-rose-500\",\n  },\n};\n\nconst formatBytes = (bytes: number) => {\n  if (!Number.isFinite(bytes)) return \"—\";\n  if (bytes === 0) return \"0 B\";\n  const units = [\"B\", \"KB\", \"MB\", \"GB\"];\n  const index = Math.floor(Math.log(bytes) / Math.log(1024));\n  const value = bytes / Math.pow(1024, index);\n  return `${value.toFixed(value > 9 || index === 0 ? 0 : 1)} ${units[index]}`;\n};\n\nconst safeJsonParse = (value: string) => {\n  try {\n    return JSON.parse(value);\n  } catch {\n    return null;\n  }\n};\n\nconst getFileLabel = (fileName: string) => {\n  const extension = fileName.split(\".\").pop()?.toLowerCase();\n  switch (extension) {\n    case \"json\":\n      return { label: \"JSON\", style: \"bg-violet-100 text-violet-700\" };\n    case \"pdf\":\n      return { label: \"PDF\", style: \"bg-rose-100 text-rose-700\" };\n    case \"xls\":\n    case \"xlsx\":\n      return { label: \"XLS\", style: \"bg-emerald-100 text-emerald-700\" };\n    case \"doc\":\n    case \"docx\":\n      return { label: \"DOC\", style: \"bg-sky-100 text-sky-700\" };\n    default:\n      return { label: \"FILE\", style: \"bg-slate-100 text-slate-600\" };\n  }\n};\n\nconst describeExtractionPersistenceError = (result?: PersistenceResult) => {\n  if (!result) {\n    return \"Extraction context could not be cached in this browser.\";\n  }\n  switch (result.reason) {\n    case \"quota\":\n      return \"Browser storage is full. Clear other extraction tabs or reduce the payload size and try again.\";\n    case \"ssr\":\n      return \"Extraction context can only be saved in a browser tab.\";\n    default:\n      return \"Extraction context could not be cached locally. Check the console for details.\";\n  }\n};\n\nconst FeedbackPill = ({ feedback }: { feedback: ApiFeedback }) => {\n  if (feedback.state === \"idle\") {\n    return null;\n  }\n\n  const className = clsx(\n    \"inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold\",\n    feedback.state === \"success\"\n      ? \"bg-emerald-50 text-emerald-700\"\n      : feedback.state === \"error\"\n        ? \"bg-rose-50 text-rose-700\"\n        : \"bg-indigo-50 text-indigo-600\",\n  );\n\n  const Icon =\n    feedback.state === \"loading\"\n      ? ArrowPathIcon\n      : feedback.state === \"success\"\n        ? CheckCircleIcon\n        : ExclamationCircleIcon;\n\n  const message =\n    feedback.message ??\n    (feedback.state === \"loading\"\n      ? \"Contacting backend...\"\n      : feedback.state === \"success\"\n        ? \"Completed successfully.\"\n        : \"Something went wrong.\");\n\n  return (\n    <div className={className}>\n      <Icon className={clsx(\"size-4\", feedback.state === \"loading\" && \"animate-spin\")} />\n      {message}\n    </div>\n  );\n};\n\nexport default function IngestionPage() {\n  const router = useRouter();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [activeTab, setActiveTab] = useState<UploadTab>(\"local\");\n  const [localFile, setLocalFile] = useState<File | null>(null);\n  const [localFileText, setLocalFileText] = useState<string | null>(null);\n  const [apiPayload, setApiPayload] = useState(\"\");\n  const [s3Uri, setS3Uri] = useState(\"\");\n  const [treeNodes, setTreeNodes] = useState<TreeNode[]>([]);\n  const [previewLabel, setPreviewLabel] = useState(\"Awaiting content\");\n  const [expandedNodes, setExpandedNodes] = useState<Set<string>>(new Set());\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [uploads, setUploads] = useState<UploadItem[]>([]);\n  const [extractFeedback, setExtractFeedback] = useState<ApiFeedback>({\n    state: \"idle\",\n  });\n  const [apiFeedback, setApiFeedback] = useState<ApiFeedback>({ state: \"idle\" });\n  const [s3Feedback, setS3Feedback] = useState<ApiFeedback>({ state: \"idle\" });\n  const [extracting, setExtracting] = useState(false);\n\n  const filteredTree = useMemo(\n    () => filterTree(treeNodes, searchQuery),\n    [treeNodes, searchQuery],\n  );\n\n  const previewLeaves = useMemo(() => {\n    if (!treeNodes.length) return [];\n    return treeNodes.flatMap((node) => gatherLeafNodes(node));\n  }, [treeNodes]);\n\n  useEffect(() => {\n    if (activeTab === \"s3\") {\n      setTreeNodes([]);\n      setPreviewLabel(\"Structure preview unavailable for S3/classpath sources.\");\n    } else if (activeTab === \"local\" && localFileText) {\n      const parsed = safeJsonParse(localFileText);\n      if (parsed) {\n        seedPreviewTree(localFile?.name ?? \"Local JSON\", parsed);\n      }\n    } else if (activeTab === \"api\" && apiPayload.trim()) {\n      const parsed = safeJsonParse(apiPayload);\n      if (parsed) {\n        seedPreviewTree(\"API payload\", parsed);\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [activeTab]);\n\n  const seedPreviewTree = (label: string, payload: unknown): TreeNode[] => {\n    const counter = { value: 0 };\n    const children = buildTreeFromJson(payload, [], counter);\n    if (!children.length) {\n      setTreeNodes([]);\n      setPreviewLabel(\"Unable to derive structure from payload.\");\n      setExpandedNodes(new Set());\n      return [];\n    }\n    const rootNode: TreeNode = {\n      id: label,\n      label,\n      path: label,\n      type: \"object\",\n      children,\n    };\n    const nodes = [rootNode];\n    setTreeNodes(nodes);\n    setPreviewLabel(label);\n    setExpandedNodes(new Set([rootNode.id]));\n    return nodes;\n  };\n\n  const handleLocalFileSelection = async (files: FileList | null) => {\n    if (!files || files.length === 0) return;\n    const [file] = Array.from(files);\n    setLocalFile(file);\n    setExtractFeedback({ state: \"idle\" });\n\n    if (file.name.toLowerCase().endsWith(\".json\")) {\n      const text = await file.text();\n      setLocalFileText(text);\n      const parsed = safeJsonParse(text);\n      if (parsed) {\n        seedPreviewTree(file.name, parsed);\n      } else {\n        setTreeNodes([]);\n        setPreviewLabel(\"Uploaded JSON could not be parsed.\");\n      }\n    } else {\n      setLocalFileText(null);\n      setTreeNodes([]);\n      setPreviewLabel(\"Select a JSON file to preview its structure.\");\n    }\n\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  };\n\n  const handleExtractData = async () => {\n    setExtracting(true);\n    setExtractFeedback({ state: \"loading\", message: \"Dispatching to backend...\" });\n\n    try {\n      if (activeTab === \"local\") {\n        await processLocalExtraction();\n      } else if (activeTab === \"api\") {\n        await processApiExtraction();\n      } else {\n        await processS3Extraction();\n      }\n    } catch (error) {\n      setExtractFeedback({\n        state: \"error\",\n        message:\n          error instanceof Error\n            ? error.message\n            : \"Extraction failed unexpectedly.\",\n      });\n      setExtracting(false);\n    }\n  };\n\n  const processLocalExtraction = async () => {\n    if (!localFile) {\n      setExtractFeedback({\n        state: \"error\",\n        message: \"Add a JSON file before extracting.\",\n      });\n      setExtracting(false);\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append(\"file\", localFile);\n\n    const uploadId = crypto.randomUUID();\n    setUploads((previous) => [\n      {\n        id: uploadId,\n        name: localFile.name,\n        size: localFile.size,\n        type: localFile.type || localFile.name.split(\".\").pop() || \"file\",\n        source: \"Local\",\n        status: \"uploading\",\n        createdAt: Date.now(),\n      },\n      ...previous,\n    ]);\n\n    const response = await fetch(\"/api/ingestion/upload\", {\n      method: \"POST\",\n      body: formData,\n    });\n    const payload = await response.json();\n    const details = parseBackendPayload(payload);\n\n    setUploads((previous) =>\n      previous.map((item) =>\n        item.id === uploadId\n          ? {\n              ...item,\n              status: response.ok ? \"success\" : \"error\",\n              cleansedId: details.cleansedId ?? item.cleansedId,\n              backendStatus: details.status ?? item.backendStatus,\n              backendMessage: details.message ?? item.backendMessage,\n            }\n          : item,\n      ),\n    );\n\n    if (!response.ok) {\n      setExtractFeedback({\n        state: \"error\",\n        message: details.message ?? \"Backend rejected the upload.\",\n      });\n      setExtracting(false);\n      return;\n    }\n\n    const fallbackIdentifier = `file-upload:${localFile.name}`;\n    const sourceIdentifier = details.sourceIdentifier ?? fallbackIdentifier;\n    const sourceType = inferSourceType(details.sourceType, sourceIdentifier, \"file\") ?? \"file\";\n    const metadata: ExtractionContext[\"metadata\"] = {\n      name: localFile.name,\n      size: localFile.size,\n      source: describeSourceLabel(sourceType, \"Local upload\"),\n      cleansedId: details.cleansedId,\n      status: details.status,\n      uploadedAt: Date.now(),\n      sourceIdentifier,\n      sourceType,\n    };\n    const snapshotId = details.cleansedId ?? uploadId;\n    let snapshotPersisted = false;\n    let resolvedSnapshotId: string | undefined;\n\n    if (snapshotId) {\n      const result = await persistSnapshot(snapshotId, {\n        mode: \"local\",\n        metadata,\n        rawJson: localFileText ?? undefined,\n        tree: treeNodes,\n        backendPayload: payload,\n      });\n      snapshotPersisted = result.ok;\n      resolvedSnapshotId = result.snapshotId;\n      if (!result.ok) {\n        console.warn(\n          \"Unable to cache extraction snapshot, falling back to session storage.\",\n          result.message,\n        );\n      }\n    }\n\n    const persistenceResult = saveExtractionContext({\n      mode: \"local\",\n      metadata,\n      snapshotId: snapshotPersisted ? resolvedSnapshotId ?? snapshotId : undefined,\n      tree: snapshotPersisted ? undefined : treeNodes,\n      rawJson: snapshotPersisted ? undefined : localFileText ?? undefined,\n      backendPayload: snapshotPersisted ? undefined : payload,\n    });\n\n    if (!persistenceResult.ok) {\n      setExtractFeedback({\n        state: \"error\",\n        message: describeExtractionPersistenceError(persistenceResult),\n      });\n      setExtracting(false);\n      return;\n    }\n\n    setExtractFeedback({\n      state: \"success\",\n      message: \"Extraction ready. Redirecting...\",\n    });\n    setExtracting(false);\n    router.push(\"/extraction\");\n  };\n\n  const processApiExtraction = async () => {\n    if (!apiPayload.trim()) {\n      setExtractFeedback({\n        state: \"error\",\n        message: \"Paste a JSON payload before extracting.\",\n      });\n      setExtracting(false);\n      return;\n    }\n\n    const parsed = safeJsonParse(apiPayload);\n    if (!parsed) {\n      setExtractFeedback({\n        state: \"error\",\n        message: \"Payload must be valid JSON before submission.\",\n      });\n      setExtracting(false);\n      return;\n    }\n\n    setApiFeedback({ state: \"loading\" });\n    const uploadId = crypto.randomUUID();\n    setUploads((previous) => [\n      {\n        id: uploadId,\n        name: \"API payload\",\n        size: apiPayload.length,\n        type: \"application/json\",\n        source: \"API\",\n        status: \"uploading\",\n        createdAt: Date.now(),\n      },\n      ...previous,\n    ]);\n\n    const response = await fetch(\"/api/ingestion/payload\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ payload: parsed }),\n    });\n    const payload = await response.json();\n    const details = parseBackendPayload(payload);\n\n    setUploads((previous) =>\n      previous.map((upload) =>\n        upload.id === uploadId\n          ? {\n              ...upload,\n              status: response.ok ? \"success\" : \"error\",\n              cleansedId: details.cleansedId ?? upload.cleansedId,\n              backendStatus: details.status ?? upload.backendStatus,\n              backendMessage:\n                details.message ?? upload.backendMessage,\n            }\n          : upload,\n      ),\n    );\n\n    setApiFeedback({\n      state: response.ok ? \"success\" : \"error\",\n      message: response.ok\n        ? \"Payload accepted.\"\n        : \"Backend rejected the payload.\",\n    });\n\n    if (!response.ok) {\n      setExtractFeedback({\n        state: \"error\",\n        message: details.message ?? \"Backend rejected the payload.\",\n      });\n      setExtracting(false);\n      return;\n    }\n\n    const previewNodes = seedPreviewTree(\"API payload\", parsed);\n\n    const fallbackIdentifier = details.cleansedId ?? `api-payload:${uploadId}`;\n    const sourceIdentifier = details.sourceIdentifier ?? fallbackIdentifier;\n    const sourceType = inferSourceType(details.sourceType, sourceIdentifier, \"api\") ?? \"api\";\n    const metadata: ExtractionContext[\"metadata\"] = {\n      name: \"API payload\",\n      size: apiPayload.length,\n      source: describeSourceLabel(sourceType, \"API payload\"),\n      cleansedId: details.cleansedId,\n      status: details.status,\n      uploadedAt: Date.now(),\n      sourceIdentifier,\n      sourceType,\n    };\n    const snapshotId = details.cleansedId ?? uploadId;\n    const serializedPayload = JSON.stringify(parsed, null, 2);\n\n    let snapshotPersisted = false;\n    let resolvedSnapshotId: string | undefined;\n    if (snapshotId) {\n      const snapshotResult = await persistSnapshot(snapshotId, {\n        mode: \"api\",\n        metadata,\n        rawJson: serializedPayload,\n        tree: previewNodes,\n        backendPayload: payload,\n      });\n      snapshotPersisted = snapshotResult.ok;\n      resolvedSnapshotId = snapshotResult.snapshotId;\n      if (!snapshotResult.ok) {\n        console.warn(\n          \"Unable to cache API extraction snapshot, falling back to browser session storage.\",\n          snapshotResult.message,\n        );\n      }\n    }\n\n    const persistenceResult = saveExtractionContext({\n      mode: \"api\",\n      metadata,\n      snapshotId: snapshotPersisted ? resolvedSnapshotId ?? snapshotId : undefined,\n      tree: snapshotPersisted ? undefined : previewNodes,\n      rawJson: snapshotPersisted ? undefined : serializedPayload,\n      backendPayload: snapshotPersisted ? undefined : payload,\n    });\n\n    if (!persistenceResult.ok) {\n      setExtractFeedback({\n        state: \"error\",\n        message: describeExtractionPersistenceError(persistenceResult),\n      });\n      setExtracting(false);\n      return;\n    }\n\n    setExtractFeedback({\n      state: \"success\",\n      message: \"Extraction ready. Redirecting...\",\n    });\n    setExtracting(false);\n    router.push(\"/extraction\");\n  };\n\n  const processS3Extraction = async () => {\n    const normalized = s3Uri.trim();\n    if (!normalized) {\n      setExtractFeedback({\n        state: \"error\",\n        message: \"Provide an s3://bucket/key (or classpath:) URI first.\",\n      });\n      setExtracting(false);\n      return;\n    }\n\n    setS3Feedback({ state: \"loading\" });\n    const uploadId = crypto.randomUUID();\n    setUploads((previous) => [\n      {\n        id: uploadId,\n        name: normalized,\n        size: 0,\n        type: \"text/uri-list\",\n        source: \"S3\",\n        status: \"uploading\",\n        createdAt: Date.now(),\n      },\n      ...previous,\n    ]);\n\n    const response = await fetch(\"/api/ingestion/s3\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ sourceUri: normalized }),\n    });\n    const payload = await response.json();\n    const details = parseBackendPayload(payload);\n\n    setUploads((previous) =>\n      previous.map((upload) =>\n        upload.id === uploadId\n          ? {\n              ...upload,\n              status: response.ok ? \"success\" : \"error\",\n              cleansedId: details.cleansedId ?? upload.cleansedId,\n              backendStatus:\n                details.status ?? (response.ok ? \"ACCEPTED\" : upload.backendStatus),\n              backendMessage:\n                details.message ?? upload.backendMessage,\n            }\n          : upload,\n      ),\n    );\n\n    setS3Feedback({\n      state: response.ok ? \"success\" : \"error\",\n      message: response.ok\n        ? \"Source accepted.\"\n        : \"Backend rejected the S3/classpath request.\",\n    });\n\n    if (!response.ok) {\n      setExtractFeedback({\n        state: \"error\",\n        message: details.message ?? \"Backend rejected the request.\",\n      });\n      setExtracting(false);\n      return;\n    }\n\n    const sourceIdentifier = details.sourceIdentifier ?? normalized;\n    const sourceType = inferSourceType(details.sourceType, sourceIdentifier, \"s3\") ?? \"s3\";\n    const metadata: ExtractionContext[\"metadata\"] = {\n      name: normalized,\n      size: 0,\n      source: describeSourceLabel(sourceType, \"S3 / Cloud\"),\n      cleansedId: details.cleansedId,\n      status: details.status,\n      uploadedAt: Date.now(),\n      sourceIdentifier,\n      sourceType,\n    };\n    const snapshotId = details.cleansedId ?? uploadId;\n\n    let snapshotPersisted = false;\n    let resolvedSnapshotId: string | undefined;\n    if (snapshotId) {\n      const snapshotResult = await persistSnapshot(snapshotId, {\n        mode: \"s3\",\n        metadata,\n        sourceUri: normalized,\n        backendPayload: payload,\n      });\n      snapshotPersisted = snapshotResult.ok;\n      resolvedSnapshotId = snapshotResult.snapshotId;\n      if (!snapshotResult.ok) {\n        console.warn(\n          \"Unable to cache S3 extraction snapshot, falling back to session storage metadata only.\",\n          snapshotResult.message,\n        );\n      }\n    }\n\n    const persistenceResult = saveExtractionContext({\n      mode: \"s3\",\n      metadata,\n      sourceUri: normalized,\n      snapshotId: snapshotPersisted ? resolvedSnapshotId ?? snapshotId : undefined,\n      backendPayload: snapshotPersisted ? undefined : payload,\n    });\n\n    if (!persistenceResult.ok) {\n      setExtractFeedback({\n        state: \"error\",\n        message: describeExtractionPersistenceError(persistenceResult),\n      });\n      setExtracting(false);\n      return;\n    }\n\n    setExtractFeedback({\n      state: \"success\",\n      message: \"Extraction ready. Redirecting...\",\n    });\n    setExtracting(false);\n    router.push(\"/extraction\");\n  };\n\n  const parseBackendPayload = (payload: any) => {\n    const body = payload?.body;\n    const rawBody = payload?.rawBody;\n\n    const bodyRecord =\n      body && typeof body === \"object\" && !Array.isArray(body)\n        ? (body as Record<string, unknown>)\n        : null;\n    const metadataRecord =\n      bodyRecord?.metadata && typeof bodyRecord.metadata === \"object\"\n        ? (bodyRecord.metadata as Record<string, unknown>)\n        : null;\n\n    const cleansedId =\n      pickString(bodyRecord?.cleansedDataStoreId) ??\n      pickString(bodyRecord?.cleansedId) ??\n      pickString(bodyRecord?.id);\n    const status = pickString(bodyRecord?.status);\n\n    const pickMessage = (source: unknown) => {\n      const direct = pickString(source);\n      if (direct) return direct;\n      if (source && typeof source === \"object\") {\n        const candidates = [\n          (source as Record<string, unknown>)[\"error\"],\n          (source as Record<string, unknown>)[\"message\"],\n          (source as Record<string, unknown>)[\"detail\"],\n          (source as Record<string, unknown>)[\"statusText\"],\n          (source as Record<string, unknown>)[\"description\"],\n        ];\n        for (const candidate of candidates) {\n          const value = pickString(candidate);\n          if (value) return value;\n        }\n      }\n      return undefined;\n    };\n\n    const deriveSourceIdentifier = () => {\n      return (\n        pickString(bodyRecord?.sourceIdentifier) ??\n        pickString(bodyRecord?.sourceUri) ??\n        pickString(metadataRecord?.sourceIdentifier) ??\n        pickString(metadataRecord?.sourceUri) ??\n        pickString(payload?.sourceIdentifier) ??\n        pickString(payload?.sourceUri)\n      );\n    };\n\n    const sourceIdentifier = deriveSourceIdentifier();\n    const sourceType = inferSourceType(\n      pickString(bodyRecord?.sourceType) ?? pickString(metadataRecord?.sourceType),\n      sourceIdentifier,\n    );\n\n    const message =\n      pickMessage(body) ??\n      pickMessage(payload?.error) ??\n      pickMessage(rawBody) ??\n      (typeof rawBody === \"string\" ? rawBody : undefined);\n\n    return { cleansedId, status, message, sourceIdentifier, sourceType };\n  };\n\n  type SnapshotPayload = Omit<ExtractionSnapshot, \"storedAt\">;\n\n  const persistSnapshot = async (\n    id: string,\n    payload: SnapshotPayload,\n  ): Promise<{ ok: boolean; snapshotId?: string; message?: string }> => {\n    if (!id) {\n      return { ok: false, message: \"Snapshot id is missing.\" };\n    }\n\n    const snapshotPayload: ExtractionSnapshot = {\n      ...payload,\n      storedAt: Date.now(),\n    };\n\n    try {\n      const response = await fetch(\"/api/ingestion/context\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          id,\n          payload: {\n            ...payload,\n            mode: payload.mode,\n            metadata: payload.metadata,\n            rawJson: payload.rawJson,\n            tree: payload.tree,\n            sourceUri: payload.sourceUri,\n            backendPayload: payload.backendPayload,\n          },\n        }),\n      });\n\n      if (!response.ok) {\n        let message = \"Failed to cache extraction snapshot.\";\n        try {\n          const body = await response.json();\n          if (body?.error) message = body.error;\n        } catch {\n          // ignore\n        }\n        throw new Error(message);\n      }\n\n      return { ok: true, snapshotId: id };\n    } catch (error) {\n      const localId = `local:${id}`;\n      const localResult = await storeClientSnapshot(localId, snapshotPayload);\n      if (localResult.ok) {\n        return { ok: true, snapshotId: localId };\n      }\n\n      return {\n        ok: false,\n        message:\n          localResult.message ??\n          (error instanceof Error ? error.message : \"Failed to cache extraction snapshot.\"),\n      };\n    }\n  };\n\n  const toggleNode = (nodeId: string) => {\n    setExpandedNodes((previous) => {\n      const next = new Set(previous);\n      if (next.has(nodeId)) {\n        next.delete(nodeId);\n      } else {\n        next.add(nodeId);\n      }\n      return next;\n    });\n  };\n\n  const renderTree = (nodes: TreeNode[]) =>\n    nodes.map((node) => {\n      const hasChildren = Boolean(node.children?.length);\n      const expanded = expandedNodes.has(node.id);\n\n      return (\n        <div key={node.id} className=\"space-y-2\">\n          <div className=\"flex items-center gap-2 rounded-lg px-2 py-1.5\">\n            {hasChildren ? (\n              <button\n                type=\"button\"\n                onClick={() => toggleNode(node.id)}\n                className=\"text-slate-500 transition hover:text-slate-800\"\n                aria-label={expanded ? \"Collapse section\" : \"Expand section\"}\n              >\n                {expanded ? (\n                  <ChevronDownIcon className=\"size-4\" />\n                ) : (\n                  <ChevronRightIcon className=\"size-4\" />\n                )}\n              </button>\n            ) : (\n              <span className=\"size-4\" />\n            )}\n            <div className=\"flex flex-col\">\n              <span className=\"text-sm font-medium text-slate-900\">\n                {node.label}\n              </span>\n              {!hasChildren && (\n                <span className=\"text-xs text-slate-500\">{node.path}</span>\n              )}\n            </div>\n          </div>\n          {hasChildren && expanded && (\n            <div className=\"border-l border-slate-100 pl-4\">\n              {renderTree(node.children!)}\n            </div>\n          )}\n        </div>\n      );\n    });\n\n  return (\n    <div className=\"min-h-screen bg-slate-50\">\n      <header className=\"border-b border-slate-200 bg-white\">\n        <div className=\"mx-auto flex max-w-6xl flex-wrap items-center justify-between gap-4 px-6 py-4\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"flex h-10 w-10 items-center justify-center rounded-2xl bg-black text-lg font-semibold text-white\">\n              \n            </div>\n            <div>\n              <p className=\"text-sm text-slate-500\">Context</p>\n              <div className=\"mt-1 flex flex-wrap gap-2\">\n                <span className=\"rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-700\">\n                  EN-US\n                </span>\n                <span className=\"rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-700\">\n                  US\n                </span>\n                <span className=\"rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-700\">\n                  product-detail\n                </span>\n              </div>\n            </div>\n          </div>\n          <nav className=\"flex flex-1 justify-end gap-2 text-sm font-medium text-slate-500\">\n            {steps.map((step, index) => (\n              <div key={step.label} className=\"flex items-center gap-2\">\n                <span\n                  className={clsx(\n                    \"rounded-full px-3 py-1\",\n                    step.status === \"current\"\n                      ? \"bg-indigo-50 text-indigo-600\"\n                      : \"bg-slate-50\",\n                  )}\n                >\n                  {step.label}\n                </span>\n                {index < steps.length - 1 && (\n                  <span className=\"text-slate-300\">—</span>\n                )}\n              </div>\n            ))}\n          </nav>\n        </div>\n      </header>\n\n      <main className=\"mx-auto grid max-w-6xl gap-6 px-6 py-8 lg:grid-cols-[minmax(0,1.6fr)_minmax(0,1fr)]\">\n        <section className=\"space-y-6\">\n          <div className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm\">\n            <div className=\"flex flex-wrap items-start justify-between gap-4\">\n              <div>\n                <p className=\"text-xs uppercase tracking-wide text-slate-400\">\n                  Ingestion\n                </p>\n                <h2 className=\"mt-1 text-xl font-semibold text-slate-900\">\n                  Upload Files\n                </h2>\n                <p className=\"text-sm text-slate-500\">\n                  Drag and drop JSON, paste payloads, or point at S3/classpath URIs.\n                </p>\n              </div>\n              <FeedbackPill feedback={extractFeedback} />\n            </div>\n\n            <div className=\"mt-6 grid gap-3 sm:grid-cols-3\">\n              {uploadTabs.map((tab) => (\n                <button\n                  key={tab.id}\n                  type=\"button\"\n                  disabled={tab.disabled}\n                  onClick={() => !tab.disabled && setActiveTab(tab.id)}\n                  className={clsx(\n                    \"rounded-2xl border px-4 py-3 text-left transition\",\n                    tab.disabled\n                      ? \"border-dashed border-slate-200 text-slate-400\"\n                      : activeTab === tab.id\n                        ? \"border-indigo-500 bg-indigo-50\"\n                        : \"border-slate-200 hover:border-indigo-200\",\n                  )}\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <tab.icon className=\"size-5 text-slate-500\" />\n                    <div>\n                      <p className=\"text-sm font-semibold text-slate-900\">\n                        {tab.title}\n                      </p>\n                      <p className=\"text-xs text-slate-500\">\n                        {tab.description}\n                      </p>\n                    </div>\n                  </div>\n                </button>\n              ))}\n            </div>\n\n            {activeTab === \"local\" && (\n              <div className=\"mt-6 rounded-2xl border border-dashed border-slate-300 bg-slate-50 p-6 text-center\">\n                <label\n                  htmlFor=\"file-upload\"\n                  onDragOver={(event) => {\n                    event.preventDefault();\n                    event.stopPropagation();\n                  }}\n                  onDrop={(event) => {\n                    event.preventDefault();\n                    event.stopPropagation();\n                    handleLocalFileSelection(event.dataTransfer.files);\n                  }}\n                  className=\"flex cursor-pointer flex-col items-center gap-4\"\n                >\n                  <ArrowUpTrayIcon className=\"size-10 text-indigo-500\" />\n                  <div>\n                    <p className=\"text-sm font-semibold text-slate-900\">\n                      Drag a JSON file here or <span className=\"text-indigo-600 underline\">browse</span>\n                    </p>\n                    <p className=\"text-xs text-slate-500\">\n                      Single-file uploads only. Max 50 MB.\n                    </p>\n                    {localFile && (\n                      <p className=\"mt-1 text-xs text-slate-500\">\n                        Selected: <span className=\"font-semibold text-slate-800\">{localFile.name}</span>\n                      </p>\n                    )}\n                  </div>\n                  <input\n                    id=\"file-upload\"\n                    ref={fileInputRef}\n                    type=\"file\"\n                    className=\"sr-only\"\n                    accept=\".json,application/json\"\n                    onChange={(event) => handleLocalFileSelection(event.target.files)}\n                  />\n                </label>\n              </div>\n            )}\n\n            {activeTab === \"api\" && (\n              <div className=\"mt-6 space-y-4 rounded-2xl border border-slate-200 bg-slate-50 p-4\">\n                <div className=\"flex items-center gap-2 text-sm font-semibold text-slate-900\">\n                  <ServerStackIcon className=\"size-5 text-indigo-500\" />\n                  POST /api/ingest-json-payload\n                </div>\n                <textarea\n                  value={apiPayload}\n                  onChange={(event) => {\n                    setApiPayload(event.target.value);\n                    const parsed = safeJsonParse(event.target.value);\n                    if (parsed) {\n                      seedPreviewTree(\"API payload\", parsed);\n                      setApiFeedback({ state: \"idle\" });\n                    }\n                  }}\n                  rows={6}\n                  placeholder='Paste JSON payload. Example: { \"product\": { \"name\": \"Vision Pro\" } }'\n                  className=\"w-full rounded-xl border border-slate-200 bg-white p-3 text-sm text-slate-900 shadow-inner focus:border-indigo-500 focus:outline-none\"\n                />\n                <FeedbackPill feedback={apiFeedback} />\n              </div>\n            )}\n\n            {activeTab === \"s3\" && (\n              <div className=\"mt-6 space-y-4 rounded-2xl border border-slate-200 bg-slate-50 p-4\">\n                <div className=\"flex items-center gap-2 text-sm font-semibold text-slate-900\">\n                  <CloudArrowUpIcon className=\"size-5 text-indigo-500\" />\n                  GET /api/extract-cleanse-enrich-and-store\n                </div>\n                <input\n                  value={s3Uri}\n                  onChange={(event) => setS3Uri(event.target.value)}\n                  placeholder=\"s3://my-bucket/path/to/file.json\"\n                  className=\"w-full rounded-xl border border-slate-200 bg-white p-3 text-sm text-slate-900 shadow-inner focus:border-indigo-500 focus:outline-none\"\n                />\n                <p className=\"text-xs text-slate-500\">\n                  Accepts s3://bucket/key or classpath:relative/path references that the Spring Boot service can access.\n                </p>\n                <FeedbackPill feedback={s3Feedback} />\n              </div>\n            )}\n          </div>\n\n          <div className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm\">\n            <div className=\"flex flex-wrap items-center justify-between gap-3\">\n              <h3 className=\"text-lg font-semibold text-slate-900\">Upload History</h3>\n              <div className=\"relative w-full max-w-xs\">\n                <MagnifyingGlassIcon className=\"pointer-events-none absolute left-3 top-2.5 size-4 text-slate-400\" />\n                <input\n                  type=\"search\"\n                  placeholder=\"Search coming soon\"\n                  className=\"w-full cursor-not-allowed rounded-full border border-slate-200 bg-slate-50 py-2 pl-9 pr-3 text-sm text-slate-400\"\n                  disabled\n                />\n              </div>\n            </div>\n\n            <div className=\"mt-4 space-y-4\">\n              {uploads.length === 0 && (\n                <div className=\"rounded-2xl border border-dashed border-slate-200 py-10 text-center text-sm text-slate-500\">\n                  No uploads yet. Drop a JSON file to start the pipeline.\n                </div>\n              )}\n              {uploads.map((upload) => {\n                const status = statusStyles[upload.status];\n                return (\n                  <div\n                    key={upload.id}\n                    className=\"flex flex-wrap items-center justify-between gap-4 rounded-2xl border border-slate-100 bg-slate-50 px-4 py-3\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"rounded-2xl bg-white p-2 shadow-sm\">\n                        <DocumentTextIcon className=\"size-5 text-slate-500\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm font-semibold text-slate-900\">\n                          {upload.name}\n                        </p>\n                        <p className=\"text-xs text-slate-500\">\n                          {new Date(upload.createdAt).toLocaleString()} • {upload.source}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-3\">\n                      {upload.cleansedId && (\n                        <code className=\"rounded-full bg-white px-3 py-1 text-xs font-semibold text-slate-600 shadow-inner\">\n                          {upload.cleansedId}\n                        </code>\n                      )}\n                      <span\n                        className={clsx(\n                          \"inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold\",\n                          status.className,\n                        )}\n                      >\n                        <span className={clsx(\"size-2 rounded-full\", status.dot)} />\n                        {status.label}\n                      </span>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        </section>\n\n        <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-xs uppercase tracking-wide text-slate-400\">\n                Preview\n              </p>\n              <h3 className=\"text-lg font-semibold text-slate-900\">\n                Select Items\n              </h3>\n              <p className=\"text-xs text-slate-500\">Preview is read-only. All fields will be sent forward.</p>\n            </div>\n            <span className=\"text-sm font-semibold text-slate-600\">\n              {previewLeaves.length} fields\n            </span>\n          </div>\n          <div className=\"mt-4 flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1.5\">\n            <InboxStackIcon className=\"size-4 text-slate-500\" />\n            <span className=\"text-xs font-semibold text-slate-600\">\n              {previewLabel}\n            </span>\n          </div>\n\n          <div className=\"mt-4\">\n            <div className=\"relative\">\n              <MagnifyingGlassIcon className=\"pointer-events-none absolute left-3 top-2.5 size-4 text-slate-400\" />\n              <input\n                type=\"search\"\n                placeholder=\"Search fields...\"\n                value={searchQuery}\n                onChange={(event) => setSearchQuery(event.target.value)}\n                className=\"w-full rounded-2xl border border-slate-200 bg-slate-50 py-2 pl-9 pr-3 text-sm text-slate-900 focus:border-indigo-500 focus:bg-white focus:outline-none\"\n              />\n            </div>\n            <div className=\"mt-4 max-h-[420px] overflow-y-auto pr-2\">\n              {filteredTree.length === 0 ? (\n                <div className=\"rounded-2xl border border-dashed border-slate-200 py-10 text-center text-sm text-slate-500\">\n                  Upload a JSON payload to view its structure.\n                </div>\n              ) : (\n                <div className=\"space-y-3\">{renderTree(filteredTree)}</div>\n              )}\n            </div>\n          </div>\n\n          <div className=\"mt-6 rounded-2xl bg-slate-50 p-4\">\n            <div className=\"flex flex-wrap items-center gap-2 text-xs text-slate-600\">\n              <span className=\"font-semibold text-slate-800\">Fields:</span>\n              {previewLeaves.slice(0, 6).map((leaf) => (\n                <span\n                  key={leaf.id}\n                  className=\"rounded-full bg-white px-3 py-1 font-semibold shadow-sm\"\n                >\n                  {leaf.label}\n                </span>\n              ))}\n              {previewLeaves.length > 6 && (\n                <span className=\"rounded-full bg-white px-3 py-1 font-semibold shadow-sm\">\n                  +{previewLeaves.length - 6} more\n                </span>\n              )}\n            </div>\n            <button\n              type=\"button\"\n              onClick={handleExtractData}\n              disabled={extracting}\n              className={clsx(\n                \"mt-4 w-full rounded-full bg-slate-900 py-2.5 text-sm font-semibold text-white transition hover:bg-black\",\n                extracting && \"cursor-not-allowed opacity-60 hover:bg-slate-900\",\n              )}\n            >\n              {extracting ? (\n                <span className=\"inline-flex items-center justify-center gap-2\">\n                  <ArrowPathIcon className=\"size-4 animate-spin\" />\n                  Extracting…\n                </span>\n              ) : (\n                \"Extract Data\"\n              )}\n            </button>\n          </div>\n        </section>\n      </main>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}