(()=>{var e={};e.id=489,e.ids=[489],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},9551:e=>{"use strict";e.exports=require("url")},7111:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>o});var a=s(260),r=s(8203),l=s(5155),n=s.n(l),i=s(7292),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["ingestion",{children:["activity",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4682)),"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/ingestion/activity/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,1354)),"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,1485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/ingestion/activity/page.tsx"],x={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/ingestion/activity/page",pathname:"/ingestion/activity",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6254:(e,t,s)=>{Promise.resolve().then(s.bind(s,4682))},4145:(e,t,s)=>{Promise.resolve().then(s.bind(s,2558))},2558:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(5512),r=s(9356),l=s(9174),n=s(4193),i=s(8390),d=s(2281),o=s(8009),c=s(9199),x=s(6287);s(7068);let p={uploading:{label:"Uploading",className:"bg-amber-50 text-amber-700",dot:"bg-amber-400"},success:{label:"Accepted",className:"bg-emerald-50 text-emerald-700",dot:"bg-emerald-500"},error:{label:"Error",className:"bg-rose-50 text-rose-700",dot:"bg-rose-500"}},m=e=>{if(!Number.isFinite(e))return"—";if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024)),s=e/Math.pow(1024,t);return`${s.toFixed(s>9||0===t?0:1)} ${["B","KB","MB","GB"][t]}`};function u(){let[e,t]=(0,o.useState)([]),[s,u]=(0,o.useState)(null),[h,b]=(0,o.useState)(null),[g,f]=(0,o.useState)(!1),w=(0,o.useMemo)(()=>e.find(e=>e.id===s)??null,[e,s]),v=e=>{t(t=>{let a=t.filter(t=>t.id!==e);return 0===a.length?u(null):s===e&&u(a[0].id),a})},j=async e=>{if(!e.cleansedId){window.alert("Download is available after the backend returns a cleansed ID.");return}b(e.id);try{let t=await fetch(`/api/ingestion/resume/${encodeURIComponent(e.cleansedId)}`,{method:"POST"}),s=await t.json();if(!t.ok)throw Error(s?.error??"Backend rejected the download request.");let a="object"==typeof s.body&&null!==s.body?JSON.stringify(s.body,null,2):"string"==typeof s.rawBody&&s.rawBody.trim()?s.rawBody:JSON.stringify(s,null,2),r=new Blob([a],{type:"application/json"}),l=e.name.split("/").pop()?.replace(/[^\w.-]+/g,"_")||"upload",n=`${l}-${e.cleansedId}.json`,i=URL.createObjectURL(r),d=document.createElement("a");d.href=i,d.download=n,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(i)}catch(e){console.error("Unable to download upload payload.",e),window.alert(e instanceof Error?e.message:"Unable to download this upload. Please try again later.")}finally{b(t=>t===e.id?null:t)}};return(0,a.jsxs)(c.l,{currentStep:"ingestion",children:[(0,a.jsx)(x.F,{title:"Upload activity",description:"Review previous uploads, download payloads, and inspect metadata captured during ingestion."}),(0,a.jsxs)("main",{className:"mx-auto grid max-w-6xl gap-6 px-6 py-10 lg:grid-cols-[minmax(0,1.4fr)_minmax(0,1fr)]",children:[(0,a.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Upload history"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Recent files"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-full bg-slate-50 px-3 py-1 text-xs text-slate-600",children:[(0,a.jsx)(r.A,{className:"size-4 text-slate-500"}),e.length?`${Math.min(e.length,25)} tracked`:"No uploads tracked yet"]})]}),(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[0===e.length&&(0,a.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-200 py-10 text-center text-sm text-slate-500",children:"Uploads will appear here once you submit files from the ingestion screen."}),e.map(e=>{let t=p[e.status],r=h===e.id,o=s===e.id;return(0,a.jsxs)("div",{className:(0,d.A)("rounded-2xl border px-4 py-3 transition",o?"border-slate-900 bg-slate-900/[0.04] shadow-[0_18px_35px_rgba(15,23,42,0.08)]":"border-slate-100 bg-slate-50 hover:border-slate-300"),children:[(0,a.jsxs)("button",{type:"button",onClick:()=>u(e.id),className:"flex w-full flex-wrap items-center justify-between gap-4 text-left",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"rounded-2xl bg-white p-2 shadow-sm",children:(0,a.jsx)(l.A,{className:"size-5 text-slate-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[new Date(e.createdAt).toLocaleString()," • ",e.source]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:(0,d.A)("inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold",t.className),children:[(0,a.jsx)("span",{className:(0,d.A)("size-2 rounded-full",t.dot)}),t.label]})})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-end gap-2 border-t border-slate-100 pt-3",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>j(e),disabled:r,className:(0,d.A)("inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold text-slate-900 transition hover:bg-slate-900/10",r&&"cursor-wait opacity-60"),children:[(0,a.jsx)(n.A,{className:"size-4"}),"Download"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>v(e.id),className:"inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold text-slate-900 transition hover:bg-slate-900/10",children:[(0,a.jsx)(i.A,{className:"size-4"}),"Delete"]})]})]},e.id)})]})]}),(0,a.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"File metadata"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:w?w.name:"Select an upload"})]}),w&&(0,a.jsx)("span",{className:"text-xs font-semibold uppercase tracking-[0.25em] text-slate-400",children:w.source})]}),w?(0,a.jsxs)("div",{className:"mt-5 space-y-5",children:[(0,a.jsxs)("dl",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Uploaded"}),(0,a.jsx)("dd",{className:"text-sm font-semibold text-slate-900",children:new Date(w.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Size"}),(0,a.jsx)("dd",{className:"text-sm font-semibold text-slate-900",children:m(w.size)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Source type"}),(0,a.jsx)("dd",{className:"text-sm font-semibold text-slate-900",children:w.sourceType??w.source})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Source identifier"}),(0,a.jsx)("dd",{className:"text-sm font-semibold text-slate-900 break-all",children:w.sourceIdentifier??"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Cleansed ID"}),(0,a.jsx)("dd",{className:"text-sm font-semibold text-slate-900",children:w.cleansedId??"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Backend status"}),(0,a.jsx)("dd",{className:"text-sm font-semibold text-slate-900",children:w.backendStatus??"—"})]})]}),w.backendMessage&&(0,a.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4 text-sm text-slate-700",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Backend message"}),(0,a.jsx)("p",{className:"mt-1",children:w.backendMessage})]})]}):(0,a.jsx)("div",{className:"mt-10 rounded-2xl border border-dashed border-slate-200 py-10 text-center text-sm text-slate-500",children:"Select an upload from the list to inspect its metadata."})]})]})]})}},7068:(e,t,s)=>{"use strict";s.d(t,{Vj:()=>r,cB:()=>a});let a=()=>[],r=e=>{}},4682:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/ingestion/activity/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/ingestion/activity/page.tsx","default")},4193:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(8009);let r=a.forwardRef(function({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))})},9174:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(8009);let r=a.forwardRef(function({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))})},9356:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(8009);let r=a.forwardRef(function({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m7.875 14.25 1.214 1.942a2.25 2.25 0 0 0 1.908 1.058h2.006c.776 0 1.497-.4 1.908-1.058l1.214-1.942M2.41 9h4.636a2.25 2.25 0 0 1 1.872 1.002l.164.246a2.25 2.25 0 0 0 1.872 1.002h2.092a2.25 2.25 0 0 0 1.872-1.002l.164-.246A2.25 2.25 0 0 1 16.954 9h4.636M2.41 9a2.25 2.25 0 0 0-.16.832V12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 12V9.832c0-.287-.055-.57-.16-.832M2.41 9a2.25 2.25 0 0 1 .382-.632l3.285-3.832a2.25 2.25 0 0 1 1.708-.786h8.43c.657 0 1.281.287 1.709.786l3.284 3.832c.163.19.291.404.382.632M4.5 20.25h15A2.25 2.25 0 0 0 21.75 18v-2.625c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125V18a2.25 2.25 0 0 0 2.25 2.25Z"}))})},8390:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(8009);let r=a.forwardRef(function({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[638,619,77,30,546],()=>s(7111));module.exports=a})();