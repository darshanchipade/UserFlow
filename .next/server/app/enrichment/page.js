(()=>{var e={};e.id=610,e.ids=[610],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},9551:e=>{"use strict";e.exports=require("url")},4097:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>o});var r=s(260),a=s(8203),l=s(5155),n=s.n(l),i=s(7292),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["enrichment",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,3621)),"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/enrichment/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,1354)),"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,1485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/enrichment/page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/enrichment/page",pathname:"/enrichment",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},8091:(e,t,s)=>{Promise.resolve().then(s.bind(s,4076))},4115:(e,t,s)=>{Promise.resolve().then(s.bind(s,8403))},9334:(e,t,s)=>{"use strict";var r=s(8686);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},8403:(e,t,s)=>{"use strict";s.d(t,{default:()=>M});var r=s(5512),a=s(8483),l=s(8523),n=s(8009),i=s(9334),d=s(3779),o=s(9199),c=s(6287),m=s(6193);let u=["analytics","disclaimers","pageanalyticsattributes","alt","analyticsattributes","url"],x={ENRICHMENT_TRIGGERED:"Queued for enrichment",WAITING_FOR_RESULTS:"Awaiting AI output",ENRICHMENT_RUNNING:"Enrichment running",PARTIALLY_ENRICHED:"Partially enriched",ENRICHMENT_COMPLETE:"Enrichment complete",ERROR:"Failed"},p={ENRICHMENT_TRIGGERED:{className:"text-indigo-700",dot:"bg-indigo-400",background:"bg-indigo-50"},WAITING_FOR_RESULTS:{className:"text-amber-700",dot:"bg-amber-400",background:"bg-amber-50"},ENRICHMENT_RUNNING:{className:"text-sky-700",dot:"bg-sky-400",background:"bg-sky-50"},ENRICHMENT_COMPLETE:{className:"text-emerald-700",dot:"bg-emerald-500",background:"bg-emerald-50"},PARTIALLY_ENRICHED:{className:"text-sky-700",dot:"bg-sky-400",background:"bg-sky-50"},ERROR:{className:"text-rose-700",dot:"bg-rose-400",background:"bg-rose-50"}},h=e=>"object"==typeof e&&null!==e,f=e=>{try{let t=JSON.parse(e);if(Array.isArray(t))return t.map(e=>"string"==typeof e?e.trim():void 0).filter(e=>!!e)}catch{}return[]},g=e=>e.split(/[,|;>]+/).map(e=>e.trim()).filter(Boolean),b=e=>{if(Array.isArray(e))return e.map(e=>"string"==typeof e?e.trim():h(e)?(0,m.Xl)(e.label)??(0,m.Xl)(e.name)??(0,m.Xl)(e.value)??(0,m.Xl)(e.text)??void 0:void 0).filter(e=>!!e);if("string"==typeof e){let t=e.trim();if(!t)return[];if(t.startsWith("[")&&t.endsWith("]")){let e=f(t);if(e.length)return e}return g(t)}if(h(e)){if(Array.isArray(e.values))return b(e.values);if(Array.isArray(e.items))return b(e.items);if(Array.isArray(e.labels))return b(e.labels);if(Array.isArray(e.tags))return b(e.tags)}return[]},y=(e,t)=>{for(let s of t)for(let t of e){let e=(0,m.Xl)(t[s]);if(e)return e}},N=(e,t)=>{for(let s of t)for(let t of e){let e=b(t[s]);if(e.length)return e}return[]},j=e=>{for(let t of e){let e=(0,m.Xl)(t.sentiment)??(0,m.Xl)(t.sentimentLabel)??(0,m.Xl)(t.sentiment_label)??(0,m.Xl)(t.tone)??(0,m.Xl)(t.mood),s=F(t.sentimentScore)??F(t.sentiment_score)??F(t.score)??F(t.sentimentConfidence);if(e)return{label:e,score:s};let r=(h(t.sentiment)?t.sentiment:null)??(h(t.sentimentAnalysis)?t.sentimentAnalysis:null);if(r){let e=(0,m.Xl)(r.label)??(0,m.Xl)(r.result)??(0,m.Xl)(r.tone);if(e)return{label:e,score:F(r.score)??F(r.confidence)??s}}}return null},w=(e,t=0)=>{if(t>5||null==e)return[];if(Array.isArray(e)){let s=e.filter(h);if(s.length)return s;for(let s of e){let e=w(s,t+1);if(e.length)return e}return[]}if(h(e)){for(let t of Object.values(e))if(Array.isArray(t)){let e=t.filter(h);if(e.length)return e}for(let s of Object.values(e)){let e=w(s,t+1);if(e.length)return e}}return[]},v=(e,t,s=0)=>{if(!(s>5)&&null!=e){if(h(e)){for(let s of t)if(s in e){let t=F(e[s]);if(void 0!==t)return t}for(let r of Object.values(e)){let e=v(r,t,s+1);if(void 0!==e)return e}}else if(Array.isArray(e))for(let r of e){let e=v(r,t,s+1);if(void 0!==e)return e}}},_=e=>({totalFieldsTagged:v(e,["totalFieldsTagged","fieldsTagged","taggedFields","totalFields","fieldCount","total_fields_tagged","total_tagged_fields","total_enriched_fields","total_enriched_elements"]),readabilityDelta:v(e,["readabilityImproved","readabilityDelta","readabilityScoreDelta","readability","readabilityImprovement","readability_improved","readability_gain","readability_gain_percent","readabilityIncreasePercent"]),errorsFound:v(e,["errorsFound","errorCount","errors","errors_detected","error_total"])}),k=(e,t)=>{for(let s of t)for(let t of e){let e=F(t[s]);if(void 0!==e)return e}},E=e=>{if(!e)return{metrics:{},elements:[]};let t=h(e)&&e.body&&"object"==typeof e.body?e.body:e,s=_(t),r=[];if(h(t)){for(let e of["enriched_content_elements","enrichedContentElements","enrichment_sections","enrichmentSections","elements","records","rows","data"])if(Array.isArray(t[e])&&(r=t[e].filter(h)).length)break}if(r.length||(r=w(t)),!r.length)return{metrics:s,elements:[]};let a=r.map((e,t)=>{let s=[e];["data","attributes","meta","context","details","fields"].forEach(t=>{let r=e[t];h(r)&&s.push(r)});let r=y(s,["id","sectionId","elementId","element_id","contentId","content_id","hash","recordId"])??`element-${t}`,a=y(s,["item_original_field_name","itemOriginalFieldName","originalFieldName","original_field_name","title","label","name","field","section","heading","elementTitle","element_title","content_name"])??`Element ${t+1}`,l=y(s,["item_source_path","itemSourcePath","path","source_path","breadcrumb","hierarchy","location","elementPath","element_path","sectionPath","section_path"])??y(s,["parent","group","category"]),n=y(s,["copy","content","text","value","enrichedCopy","enriched_copy","output","body","copy_text","copyText","copyValue","aiCopy","ai_copy","cleansedText","cleansed_text","cleansedValue","cleansed_value","cleansedContent","cleansed_content","cleansedCopy","cleansed_copy"])??void 0,i=y(s,["summary","aiSummary","insights","analysis","result"])??y(s,["summary_text","ai_summary","summaryText"])??n??void 0,d=N(s,["classification","classifications","categories","category","taxonomy","classification_path","classificationPath","category_path"]),o=N(s,["keywords","keywordList","searchKeywords"]),c=N(s,["tags","labels","contentTags","tagList","content_tags"]),m=j(s);return{id:r,title:a,path:l??void 0,copy:n,summary:i,classification:d,keywords:o,tags:c,sentiment:m,meta:{fieldsTagged:k(s,["fieldsTagged","fieldCount","totalFieldsTagged","total_fields_tagged"]),readabilityDelta:k(s,["readabilityImproved","readabilityDelta","readabilityScoreDelta","readability_improved","readability_gain"]),errorsFound:k(s,["errorsFound","errorCount","errors"])}}}),l={...s};if(null==l.totalFieldsTagged){let e=a.reduce((e,t)=>e+(t.meta?.fieldsTagged??0),0)||(a.length?a.length:0);l.totalFieldsTagged=e||null}if(null==l.readabilityDelta){let e=a.find(e=>e.meta?.readabilityDelta!==void 0)?.meta?.readabilityDelta;l.readabilityDelta=e??null}if(null==l.errorsFound){let e=a.reduce((e,t)=>e+(t.meta?.errorsFound??0),0);l.errorsFound=e||null}return{metrics:l,elements:a}},I=e=>{let t=e.includes("::")?e.split("::").pop()?.trim()??e:e,s=t.split("/").filter(Boolean);return(s[s.length-1]??t).replace(/[-_]/g," ").trim()||"Enriched section"},A=(e,t)=>e.path?.trim()?e.path.trim():e.title?.trim()?`title:${e.title.trim().toLowerCase()}`:`group-${t}`,T=(e,t,s)=>e.startsWith("title:")?e.replace(/^title:/,""):t.path?.trim()?I(t.path):t.title?.trim()??`Element group ${s+1}`,R=e=>{let t=e.title?.toLowerCase().trim();return!!t&&u.some(e=>t===e||t.startsWith(`${e}[`)||t.startsWith(`${e}.`)||t.includes(`${e}:`))},C=[{status:"ENRICHMENT_TRIGGERED",timestamp:0},{status:"WAITING_FOR_RESULTS",timestamp:0}],S=async e=>{let t=await e.text(),s=t.trim(),r=null;if(s.length)try{r=JSON.parse(s)}catch{r=null}return{body:r,rawBody:(s.startsWith("<!DOCTYPE")||s.startsWith("<html"))&&e.status?`${e.status} ${e.statusText||""}`.trim()||"HTML response returned.":t}},F=e=>{if("number"==typeof e&&Number.isFinite(e))return e},P=(e,t)=>t??{name:"Unknown dataset",size:0,source:"Unknown source",uploadedAt:Date.now(),cleansedId:e},D=(e,t,s)=>{if(!e)return t;let r=e.metadata&&"object"==typeof e.metadata?e.metadata:null,a={...t};if(r){a.name=(0,m.Xl)(r.name)??a.name,a.source=(0,m.Xl)(r.source)??a.source,a.cleansedId=(0,m.Xl)(r.cleansedId)??a.cleansedId,a.sourceIdentifier=(0,m.Xl)(r.sourceIdentifier)??a.sourceIdentifier,a.sourceType=(0,m.Xl)(r.sourceType)??a.sourceType;let e=F(r.uploadedAt);e&&(a.uploadedAt=e);let t=F(r.size);void 0!==t&&(a.size=t)}let l=(0,m.Xl)(e.sourceIdentifier)??(0,m.Xl)(e.sourceUri)??a.sourceIdentifier,n=(0,m.Me)((0,m.Xl)(e.sourceType),l??a.sourceIdentifier,a.sourceType)??a.sourceType;return a.sourceIdentifier=l??a.sourceIdentifier,a.sourceType=n,a.source=(0,m.VG)(n,a.source),a.cleansedId=(0,m.Xl)(e.cleansedId)??(0,m.Xl)(e.cleansedDataStoreId)??a.cleansedId??s,a},L=e=>e?{metadata:e.metadata,startedAt:e.startedAt,statusHistory:e.statusHistory}:null,U=e=>{if("string"==typeof e)return e;if(e&&"object"==typeof e){for(let t of["summary","aiSummary","insights","result","text","content"]){let s=e[t];if("string"==typeof s&&s.trim())return s}return JSON.stringify(e,null,2)}return"Awaiting enrichment results."};function M(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)().get("id"),s=L((0,d.rS)()),[u,h]=(0,n.useState)(s),[f,g]=(0,n.useState)(!s),[b,y]=(0,n.useState)(null),[N,j]=(0,n.useState)({state:"idle"}),[w,v]=(0,n.useState)({state:"idle"}),[_,k]=(0,n.useState)(null),[M,G]=(0,n.useState)(null),[$,H]=(0,n.useState)(null),[X,O]=(0,n.useState)(t??s?.metadata.cleansedId??null),W=async e=>{let t=await fetch(`/api/ingestion/enrichment/status?id=${encodeURIComponent(e)}`),{body:r,rawBody:a}=await S(t);if(!t.ok)throw Error(r?.error??a??"Backend rejected the enrichment status request.");let l=r??{},n=null;l.body&&"object"==typeof l.body?n=l.body:"body"in l||"object"!=typeof l||(n=l);let i=D(n,P(e,s?.metadata??void 0),e),d=Array.isArray(n?.statusHistory)?n?.statusHistory:null;return{metadata:i,startedAt:F(n?.startedAt)??F(l.startedAt)??Date.now(),statusHistory:d&&d.length?d:C}},q=async(e,t={})=>{let{showSpinner:r=!0,rethrowOnError:a=!1}=t;if(!e)return g(!1),y("Provide a cleansed ID via the URL or trigger a new run."),h(s),null;r&&g(!0),y(null);try{let t=await W(e);return h(t),t}catch(e){if(y(e instanceof Error?e.message:"Unable to load enrichment status."),!r&&s?h(s):s||h(null),a)throw e;return null}finally{r&&g(!1)}},B=async(e,t=!0)=>{t&&v({state:"loading"});try{let t=await fetch(`/api/ingestion/enrichment/result?id=${encodeURIComponent(e)}`),{body:s,rawBody:r}=await S(t);if(!t.ok){if(404===t.status){k(null),G("Awaiting enrichment results."),v({state:"idle"});return}throw Error(s?.error??r??"Backend rejected the enrichment result request.")}let a=s??{},l=E(a);k(l);let n=a.body??a.rawBody??r??"Awaiting enrichment results.";l.elements.length?(G(null),h(e=>e)):G(U(n)),v({state:"idle"})}catch(e){k(null),G(null),v({state:"error",message:e instanceof Error?e.message:"Unable to load enrichment results."})}},z=(0,n.useMemo)(()=>_?.elements.length?_.elements.filter(e=>!R(e)):[],[_?.elements]),J=(0,n.useMemo)(()=>{if(!z.length)return[];let e=new Map;return z.forEach((t,s)=>{let r=A(t,s),a=e.get(r);if(a){a.elements.push(t);return}e.set(r,{label:T(r,t,s),elements:[t]})}),Array.from(e.entries()).map(([e,t])=>({id:e||`group-${t.label}-${t.elements.length}`,label:t.label,elements:t.elements}))},[z]),[V,K]=(0,n.useState)(new Set),Y=e=>{K(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},Q=e=>{H(t=>t===e?null:e)},Z=u?.statusHistory?.length?u.statusHistory:C,ee=Z[Z.length-1]?.status??"WAITING_FOR_RESULTS",et=p[ee]??{className:"text-slate-700",dot:"bg-slate-300",background:"bg-slate-100"},es=(0,n.useMemo)(()=>{let e=["ENRICHMENT_TRIGGERED","WAITING_FOR_RESULTS","ENRICHMENT_RUNNING","PARTIALLY_ENRICHED","ENRICHMENT_COMPLETE"],t=e.findIndex(e=>e===ee);return t>=0?(t+1)/e.length*100:Math.min(Z.length,e.length)/e.length*100},[ee,Z.length]),er=_?.metrics??{},ea=null!==er.totalFieldsTagged&&void 0!==er.totalFieldsTagged?Math.round(er.totalFieldsTagged):null,el=null!==er.readabilityDelta&&void 0!==er.readabilityDelta?er.readabilityDelta:null,en=null!==er.errorsFound&&void 0!==er.errorsFound?er.errorsFound:null,ei=null!==el&&Number.isFinite(el)?1>=Math.abs(el)?100*el:el:null,ed=null!==ei?`${ei>0?"+":""}${Math.round(ei)}%`:null,eo=null!==en?Math.max(0,Math.round(en)):null,ec=(e,t)=>e.length?(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(e=>(0,r.jsx)("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-1 text-xs font-semibold text-slate-700",children:e},e))}):(0,r.jsx)("p",{className:"text-sm text-slate-500",children:t}),em=async()=>{if(!X){j({state:"error",message:"Cleansed ID missing; re-run cleansing before enrichment."});return}j({state:"loading"});try{await q(X,{showSpinner:!1,rethrowOnError:!0}),j({state:"success",message:"Status refreshed."}),await B(X,!1)}catch(e){j({state:"error",message:e instanceof Error?e.message:"Unable to refresh status."})}};if(f)return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 px-6 py-20",children:(0,r.jsxs)("div",{className:"max-w-xl rounded-3xl border border-slate-200 bg-white p-10 text-center shadow-sm",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Enrichment"}),(0,r.jsx)("h1",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"Loading status…"}),(0,r.jsx)("p",{className:"mt-4 text-sm text-slate-500",children:"Fetching enrichment details from the backend. One moment please."})]})});if(!u)return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 px-6 py-20",children:(0,r.jsxs)("div",{className:"max-w-xl rounded-3xl border border-slate-200 bg-white p-10 text-center shadow-sm",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Enrichment"}),(0,r.jsx)("h1",{className:"mt-2 text-2xl font-semibold text-slate-900",children:b??"Enrichment data not found"}),(0,r.jsx)("p",{className:"mt-4 text-sm text-slate-500",children:"Trigger enrichment from the cleansing screen to review progress here."}),(0,r.jsx)("button",{type:"button",onClick:()=>e.push("/cleansing"),className:"mt-6 rounded-full bg-slate-900 px-6 py-2 text-sm font-semibold text-white",children:"Back to Cleansing"})]})});let eu=(0,m.VG)(u.metadata.sourceType??u.metadata.source,u.metadata.source),ex=u.metadata.sourceIdentifier??"—";return(0,r.jsxs)(o.l,{currentStep:"enrichment",children:[(0,r.jsx)(c.F,{title:"Enrichment",description:`Monitor enrichment for ${u.metadata.name}`,actionsSlot:"idle"!==N.state?(0,r.jsx)("div",{className:`inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold ${"loading"===N.state?"bg-indigo-50 text-indigo-600":"success"===N.state?"bg-emerald-50 text-emerald-700":"bg-rose-50 text-rose-700"}`,children:N.message??("loading"===N.state?"Refreshing status…":"success"===N.state?"Status updated.":"Unable to refresh status.")}):null}),(0,r.jsxs)("main",{className:"mx-auto flex max-w-6xl flex-col gap-6 px-6 py-10",children:[(0,r.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Current status"}),(0,r.jsxs)("div",{className:`mt-2 inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-semibold ${et.background} ${et.className}`,children:[(0,r.jsx)("span",{className:`h-2 w-2 rounded-full ${et.dot}`}),x[ee]??ee]})]}),(0,r.jsxs)("div",{className:"w-full max-w-md",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Pipeline progress"}),(0,r.jsx)("div",{className:"mt-2 h-2 rounded-full bg-slate-100",children:(0,r.jsx)("div",{className:"h-full rounded-full bg-indigo-500 transition-all",style:{width:`${es}%`}})}),(0,r.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:[Math.round(es),"% complete"]})]}),(0,r.jsx)("button",{type:"button",onClick:em,className:"rounded-full border border-slate-300 px-4 py-2 text-xs font-semibold text-slate-700 transition hover:border-indigo-300 hover:text-indigo-700",children:"Refresh Status"})]}),(0,r.jsxs)("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,r.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Total fields tagged"}),(0,r.jsx)("p",{className:"mt-2 text-2xl font-semibold text-slate-900",children:ea??"—"})]}),(0,r.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Readability improved"}),(0,r.jsx)("p",{className:"mt-2 text-2xl font-semibold text-slate-900",children:ed??"—"})]}),(0,r.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Errors found"}),(0,r.jsx)("p",{className:"mt-2 text-2xl font-semibold text-slate-900",children:eo??"—"})]})]}),(0,r.jsxs)("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Cleansed ID"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:u.metadata.cleansedId??"—"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Source"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:eu})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Source identifier"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-slate-900 break-all",children:ex})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Started at"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:new Date(u.startedAt).toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Last update"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:new Date(Z[Z.length-1]?.timestamp??u.startedAt).toLocaleString()})]})]})]}),(0,r.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Status timeline"}),(0,r.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Pipeline events"}),(0,r.jsx)("div",{className:"mt-4 space-y-4 border-l border-slate-200 pl-6",children:Z.map(e=>{let t=p[e.status]??{className:"text-slate-700",dot:"bg-slate-300"};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("span",{className:`absolute -left-[33px] mt-1 inline-flex h-3 w-3 rounded-full ${t.dot}`}),(0,r.jsx)("p",{className:`text-sm font-semibold ${t.className}`,children:x[e.status]??e.status}),(0,r.jsx)("p",{className:"text-xs text-slate-500",children:new Date(e.timestamp).toLocaleString()})]},`${e.status}-${e.timestamp}`)})})]}),(0,r.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Insights"}),(0,r.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"AI summary preview"})]}),(0,r.jsx)("span",{className:"text-xs text-slate-500",children:"Read-only snapshot of the most recent enrichment output."})]}),"loading"===w.state?(0,r.jsx)("div",{className:"mt-4 rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-6 text-sm text-slate-500",children:"Loading enrichment summary…"}):"error"===w.state?(0,r.jsxs)("div",{className:"mt-4 rounded-2xl border border-amber-200 bg-amber-50 p-4",children:[(0,r.jsx)("p",{className:"font-semibold text-amber-800",children:"Unable to load enrichment summary."}),(0,r.jsx)("p",{className:"text-xs text-amber-900/80",children:w.message}),(0,r.jsx)("button",{type:"button",onClick:()=>u.metadata.cleansedId&&B(u.metadata.cleansedId,!0),className:"mt-3 rounded-full bg-amber-600 px-3 py-1 text-xs font-semibold text-white",children:"Retry"})]}):_?.elements.length?(0,r.jsxs)("div",{className:"mt-6 rounded-2xl border border-slate-100 bg-slate-50 p-4",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Enriched sections"}),(0,r.jsxs)("div",{className:"mt-3 max-h-[480px] space-y-3 overflow-y-auto pr-2",children:[J.map(e=>{let t=V.has(e.id);return(0,r.jsxs)("div",{className:"rounded-xl border border-slate-100 bg-white",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>Y(e.id),className:"flex w-full items-center justify-between gap-3 px-4 py-2 text-left text-sm font-semibold text-slate-800",children:[(0,r.jsx)("span",{className:"flex-1 truncate",children:e.label}),(0,r.jsx)("span",{className:"text-xs font-semibold text-slate-400",children:e.elements.length}),t?(0,r.jsx)(a.A,{className:"size-4 text-slate-400"}):(0,r.jsx)(l.A,{className:"size-4 text-slate-400"})]}),t&&(0,r.jsx)("div",{className:"space-y-2 border-t border-slate-100 bg-slate-50 px-3 py-3",children:e.elements.map((e,t)=>{let s=$===e.id,n=e.path?.trim(),i=e.title?.trim()??"",d=i.length>0?i:n?I(n):`Field ${t+1}`,o=e.summary??e.copy??"No preview available.";return(0,r.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>Q(e.id),className:"flex w-full items-center justify-between gap-3 px-3 py-2 text-left text-sm text-slate-800",children:[(0,r.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:d}),n?(0,r.jsxs)("p",{className:"truncate text-xs text-slate-500",children:["Source path \xb7"," ",(0,r.jsx)("span",{className:"font-semibold text-slate-700",children:n})]}):(0,r.jsx)("p",{className:"truncate text-xs text-slate-500",children:o})]}),s?(0,r.jsx)(a.A,{className:"size-4 text-slate-400"}):(0,r.jsx)(l.A,{className:"size-4 text-slate-400"})]}),s&&(0,r.jsxs)("div",{className:"space-y-4 border-t border-slate-100 bg-slate-50 px-4 py-4 text-sm text-slate-700",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Enriched copy"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-slate-800",children:e.copy??"No enriched copy provided yet."})]}),(0,r.jsxs)("div",{className:"grid gap-4 lg:grid-cols-3",children:[(0,r.jsxs)("div",{className:"rounded-xl border border-slate-100 bg-white p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Content insights"}),(0,r.jsx)("h3",{className:"text-base font-semibold text-slate-900",children:"Summary"})]}),(0,r.jsx)("span",{className:"text-xs font-semibold text-slate-500",children:e.classification?.length?"2 fields":"1 field"})]}),(0,r.jsx)("p",{className:"mt-3 text-sm text-slate-700",children:e.summary??"Summary not available yet."}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Classification"}),ec(e.classification??[],"No classification detected.")]})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-slate-100 bg-white p-4",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Search metadata"}),(0,r.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Keywords"}),ec(e.keywords??[],"Keywords pending enrichment.")]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Content tags"}),ec(e.tags??[],"Tags pending enrichment.")]})]})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-slate-100 bg-white p-4",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Tone & sentiment"}),(0,r.jsx)("div",{className:"mt-4 rounded-2xl border border-emerald-100 bg-emerald-50 p-4",children:e.sentiment?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-emerald-700",children:e.sentiment.label}),void 0!==e.sentiment.score&&(0,r.jsxs)("p",{className:"text-xs text-emerald-800",children:["Score: ",Math.round(100*e.sentiment.score)/100]})]}):(0,r.jsx)("p",{className:"text-sm text-emerald-800/80",children:"Sentiment analytics will appear after enrichment completes."})})]})]})]})]},e.id)})})]},e.id)}),!J.length&&(0,r.jsx)("p",{className:"text-sm text-slate-500",children:"No enriched sections available yet."})]})]}):M?(0,r.jsx)("div",{className:"mt-4 rounded-2xl border border-slate-100 bg-slate-50 p-4 text-sm text-slate-700",children:(0,r.jsx)("pre",{className:"whitespace-pre-wrap",children:M})}):(0,r.jsx)("div",{className:"mt-4 rounded-2xl border border-slate-100 bg-slate-50 p-4 text-sm text-slate-500",children:"Awaiting enrichment results. Once the backend finishes generating AI insights, they’ll appear here automatically. Use the “Refresh status” button above to check for updates."})]}),(0,r.jsx)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Next steps"}),(0,r.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Wrap up or keep monitoring"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>e.push("/cleansing"),className:"rounded-full border border-slate-300 px-4 py-2 text-xs font-semibold text-slate-700",children:"Back to Cleansing"}),(0,r.jsx)("button",{type:"button",onClick:em,className:"rounded-full border border-slate-300 px-4 py-2 text-xs font-semibold text-slate-700",children:"Refresh Status"}),(0,r.jsx)("button",{type:"button",onClick:()=>{(0,d.wo)(),e.push("/ingestion")},className:"rounded-full bg-slate-900 px-4 py-2 text-xs font-semibold text-white",children:"Finish Session"})]})]})})]})]})}},3779:(e,t,s)=>{"use strict";s.d(t,{DV:()=>m,Wq:()=>n,mv:()=>c,q6:()=>x,qv:()=>d,rS:()=>p,sB:()=>u,wo:()=>h,xj:()=>i});let r="cleansed-context",a=(e,t)=>({ok:!1,reason:"ssr"}),l=e=>{let t={...e,backendPayload:void 0};return"string"==typeof t.rawJson&&t.rawJson.length>5e5&&(t.rawJson=t.rawJson.slice(0,5e5)),t},n=e=>a("extraction-context",l(e)),i=()=>null,d=()=>{},o=e=>{let t={...e,items:Array.isArray(e.items)?[...e.items]:[]};return t.items.length>150&&(t.items=t.items.slice(0,150),t.itemsTruncated=!0),"string"==typeof t.rawBody&&t.rawBody.length>2e5&&(t.rawBody=t.rawBody.slice(0,2e5),t.rawBodyTruncated=!0),t},c=e=>{let t=o(e),s=a(r,t);if(!s.ok&&"quota"===s.reason){let e=a(r,{metadata:t.metadata,status:t.status,items:[],fallbackReason:"quota"});return e.ok?{ok:!0,reason:"quota",usedFallback:!0}:e}return s},m=()=>null,u=()=>{},x=e=>a("enrichment-context",e),p=()=>null,h=()=>{}},6193:(e,t,s)=>{"use strict";s.d(t,{Me:()=>a,VG:()=>l,Xl:()=>r});let r=e=>{if("string"!=typeof e)return;let t=e.trim();return t.length?t:void 0},a=(e,t,s)=>{let r=e?.toLowerCase();if(r)return r;if(!t)return s;let a=t.toLowerCase();return a.startsWith("file-upload")||a.startsWith("local:")?"file":a.startsWith("api-payload")||a.includes("api")?"api":a.startsWith("s3://")||a.includes("s3")?"s3":a.startsWith("classpath:")?"classpath":s},l=(e,t="Unknown source")=>{if(!e)return t;let s=e.toLowerCase();return s.includes("api")?"API payload":s.includes("s3")||s.includes("cloud")?"S3 / Cloud":s.includes("class")?"Classpath resource":s.includes("local")?"Local upload":s.includes("file")?"File upload":e}},4076:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});let r=(0,s(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/enrichment/EnrichmentPageClient.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/enrichment/EnrichmentPageClient.tsx","default")},3621:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(2740),a=s(6301),l=s(4076);function n(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 px-6 py-20",children:(0,r.jsxs)("div",{className:"max-w-xl rounded-3xl border border-slate-200 bg-white p-10 text-center shadow-sm",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Enrichment"}),(0,r.jsx)("h1",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"Loading enrichment dashboard…"}),(0,r.jsx)("p",{className:"mt-4 text-sm text-slate-500",children:"Fetching the latest enrichment context."})]})}),children:(0,r.jsx)(l.default,{})})}},8483:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(8009);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))})},8523:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(8009);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))})}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,619,77,30,546],()=>s(4097));module.exports=r})();