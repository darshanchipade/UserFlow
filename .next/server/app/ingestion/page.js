(()=>{var e={};e.id=75,e.ids=[75],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},9551:e=>{"use strict";e.exports=require("url")},927:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=a(260),r=a(8203),l=a(5155),n=a.n(l),o=a(7292),i={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);a.d(t,i);let d=["",{children:["ingestion",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,7896)),"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/ingestion/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,1354)),"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,1485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/ingestion/page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/ingestion/page",pathname:"/ingestion",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2841:(e,t,a)=>{Promise.resolve().then(a.bind(a,7896))},9289:(e,t,a)=>{Promise.resolve().then(a.bind(a,7056))},9334:(e,t,a)=>{"use strict";var s=a(8686);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},7056:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var s=a(5512),r=a(8975),l=a(7880),n=a(8009);let o=n.forwardRef(function({title:e,titleId:t,...a},s){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},a),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 14.25h13.5m-13.5 0a3 3 0 0 1-3-3m3 3a3 3 0 1 0 0 6h13.5a3 3 0 1 0 0-6m-16.5-3a3 3 0 0 1 3-3h13.5a3 3 0 0 1 3 3m-19.5 0a4.5 4.5 0 0 1 .9-2.7L5.737 5.1a3.375 3.375 0 0 1 2.7-1.35h7.126c1.062 0 2.062.5 2.7 1.35l2.587 3.45a4.5 4.5 0 0 1 .9 2.7m0 0a3 3 0 0 1-3 3m0 3h.008v.008h-.008v-.008Zm0-6h.008v.008h-.008v-.008Zm-3 6h.008v.008h-.008v-.008Zm0-6h.008v.008h-.008v-.008Z"}))});var i=a(4454),d=a(788),c=a(6389),u=a(8483),p=a(8523),m=a(9708),h=a(9174),x=a(4193),f=a(8390),b=a(9356),g=a(2281),w=a(9334),y=a(9199),v=a(6287),j=a(868),k=a(3779),N=a(3838),A=a(6193);a(7068);let S=[{id:"s3",title:"Amazon S3 / Cloud",description:"Ingest directly from s3:// or classpath URIs.",icon:r.A,disabled:!1},{id:"local",title:"Local Upload",description:"Upload files directly from your device.",icon:l.A,disabled:!1},{id:"api",title:"API Endpoint",description:"Send JSON payloads programmatically.",icon:o,disabled:!1}],I={uploading:{label:"Uploading",className:"bg-amber-50 text-amber-700",dot:"bg-amber-400"},success:{label:"Accepted",className:"bg-emerald-50 text-emerald-700",dot:"bg-emerald-500"},error:{label:"Error",className:"bg-rose-50 text-rose-700",dot:"bg-rose-500"}},P=e=>{try{return JSON.parse(e)}catch{return null}},E=e=>{if(!e)return"Extraction context could not be cached in this browser.";switch(e.reason){case"quota":return"Browser storage is full. Clear other extraction tabs or reduce the payload size and try again.";case"ssr":return"Extraction context can only be saved in a browser tab.";default:return"Extraction context could not be cached locally. Check the console for details."}},U=({feedback:e})=>{if("idle"===e.state)return null;let t=(0,g.A)("inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold","success"===e.state?"bg-emerald-50 text-emerald-700":"error"===e.state?"bg-rose-50 text-rose-700":"bg-indigo-50 text-indigo-600"),a="loading"===e.state?i.A:"success"===e.state?d.A:c.A,r=e.message??("loading"===e.state?"Contacting backend...":"success"===e.state?"Completed successfully.":"Something went wrong.");return(0,s.jsxs)("div",{className:t,children:[(0,s.jsx)(a,{className:(0,g.A)("size-4","loading"===e.state&&"animate-spin")}),r]})};function C(){let e=(0,w.useRouter)(),t=(0,n.useRef)(null),a=(0,n.useRef)(null),d=(0,n.useRef)(null),[c,C]=(0,n.useState)("local"),[D,L]=(0,n.useState)(null),[O,M]=(0,n.useState)(null),[B,R]=(0,n.useState)(""),[z,J]=(0,n.useState)(""),[T,q]=(0,n.useState)([]),[F,W]=(0,n.useState)("Awaiting content"),[_,G]=(0,n.useState)(new Set),[X,V]=(0,n.useState)(""),[H,Z]=(0,n.useState)([]),[$,K]=(0,n.useState)(null),[Q,Y]=(0,n.useState)(!1),[ee,et]=(0,n.useState)({state:"idle"}),[ea,es]=(0,n.useState)({state:"idle"}),[er,el]=(0,n.useState)({state:"idle"}),[en,eo]=(0,n.useState)(!1),ei=(0,n.useMemo)(()=>(0,j.hV)(T,X),[T,X]),ed=(0,n.useMemo)(()=>T.length?T.flatMap(e=>(0,j.HW)(e)):[],[T]),ec=(e,t)=>{let a=(0,j.bZ)(t,[],{value:0});if(!a.length)return q([]),W("Unable to derive structure from payload."),G(new Set),[];let s={id:e,label:e,path:e,type:"object",children:a},r=[s];return q(r),W(e),G(new Set([s.id])),r},eu=async e=>{if(!e||0===e.length)return;let[s]=Array.from(e);L(s),et({state:"idle"});let r=crypto.randomUUID();if(a.current=r,Z(e=>[{id:r,name:s.name,size:s.size,type:s.type||s.name.split(".").pop()||"file",source:"Local",status:"uploading",createdAt:Date.now()},...e]),s.name.toLowerCase().endsWith(".json")){let e=await s.text();M(e);let t=P(e);t?ec(s.name,t):(q([]),W("Uploaded JSON could not be parsed."))}else M(null),q([]),W("Select a JSON file to preview its structure.");t.current&&(t.current.value="")},ep=async()=>{eo(!0),et({state:"loading",message:"Dispatching to backend..."});try{"local"===c?await eh():"api"===c?await ex():await ef()}catch(e){et({state:"error",message:e instanceof Error?e.message:"Extraction failed unexpectedly."}),eo(!1)}},em=e=>{if(d.current){Z(t=>t.map(t=>t.id===d.current?{...t,size:e}:t));return}let t=crypto.randomUUID();d.current=t,Z(a=>[{id:t,name:"API payload",size:e,type:"application/json",source:"API",status:"uploading",createdAt:Date.now()},...a])},eh=async()=>{let t=a.current,s=t??crypto.randomUUID();if(!D){et({state:"error",message:"Add a JSON file before extracting."}),eo(!1);return}t||(a.current=s,Z(e=>[{id:s,name:D.name,size:D.size,type:D.type||D.name.split(".").pop()||"file",source:"Local",status:"uploading",createdAt:Date.now()},...e]));try{let t;let a=new FormData;a.append("file",D);let r=await fetch("/api/ingestion/upload",{method:"POST",body:a}),l=await r.json(),n=eb(l),o=`file-upload:${D.name}`,i=n.sourceIdentifier??o,d=(0,A.Me)(n.sourceType,i,"file")??"file";if(Z(e=>e.map(e=>e.id===s?{...e,status:r.ok?"success":"error",cleansedId:n.cleansedId??e.cleansedId,backendStatus:n.status??e.backendStatus,backendMessage:n.message??e.backendMessage,sourceIdentifier:i,sourceType:d}:e)),!r.ok){et({state:"error",message:n.message??"Backend rejected the upload."}),eo(!1);return}let c={name:D.name,size:D.size,source:(0,A.VG)(d,"Local upload"),cleansedId:n.cleansedId,status:n.status,uploadedAt:Date.now(),sourceIdentifier:i,sourceType:d},u=n.cleansedId??s,p=!1;if(u){let e=await eg(u,{mode:"local",metadata:c,rawJson:O??void 0,tree:T,backendPayload:l});p=e.ok,t=e.snapshotId,e.ok||console.warn("Unable to cache extraction snapshot, falling back to session storage.",e.message)}let m=(0,k.Wq)({mode:"local",metadata:c,snapshotId:p?t??u:void 0,tree:p?void 0:T,rawJson:p?void 0:O??void 0,backendPayload:p?void 0:l});if(!m.ok){et({state:"error",message:E(m)}),eo(!1);return}et({state:"success",message:"Extraction ready. Redirecting..."}),eo(!1),e.push("/extraction")}finally{a.current=null}},ex=async()=>{if(!B.trim()){et({state:"error",message:"Paste a JSON payload before extracting."}),eo(!1);return}let t=P(B);if(!t){et({state:"error",message:"Payload must be valid JSON before submission."}),eo(!1);return}es({state:"loading"});let a=d.current,s=a??crypto.randomUUID();a?Z(e=>e.map(e=>e.id===s?{...e,size:B.length}:e)):(d.current=s,Z(e=>[{id:s,name:"API payload",size:B.length,type:"application/json",source:"API",status:"uploading",createdAt:Date.now()},...e]));try{let a;let r=await fetch("/api/ingestion/payload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:t})}),l=await r.json(),n=eb(l),o=n.cleansedId??`api-payload:${s}`,i=n.sourceIdentifier??o,d=(0,A.Me)(n.sourceType,i,"api")??"api";if(Z(e=>e.map(e=>e.id===s?{...e,status:r.ok?"success":"error",cleansedId:n.cleansedId??e.cleansedId,backendStatus:n.status??e.backendStatus,backendMessage:n.message??e.backendMessage,sourceIdentifier:i,sourceType:d}:e)),es({state:r.ok?"success":"error",message:r.ok?"Payload accepted.":"Backend rejected the payload."}),!r.ok){et({state:"error",message:n.message??"Backend rejected the payload."}),eo(!1);return}let c=ec("API payload",t),u={name:"API payload",size:B.length,source:(0,A.VG)(d,"API payload"),cleansedId:n.cleansedId,status:n.status,uploadedAt:Date.now(),sourceIdentifier:i,sourceType:d},p=n.cleansedId??s,m=JSON.stringify(t,null,2),h=!1;if(p){let e=await eg(p,{mode:"api",metadata:u,rawJson:m,tree:c,backendPayload:l});h=e.ok,a=e.snapshotId,e.ok||console.warn("Unable to cache API extraction snapshot, falling back to browser session storage.",e.message)}let x=(0,k.Wq)({mode:"api",metadata:u,snapshotId:h?a??p:void 0,tree:h?void 0:c,rawJson:h?void 0:m,backendPayload:h?void 0:l});if(!x.ok){et({state:"error",message:E(x)}),eo(!1);return}et({state:"success",message:"Extraction ready. Redirecting..."}),eo(!1),e.push("/extraction")}finally{d.current=null}},ef=async()=>{let t;let a=z.trim();if(!a){et({state:"error",message:"Provide an s3://bucket/key (or classpath:) URI first."}),eo(!1);return}el({state:"loading"});let s=crypto.randomUUID();Z(e=>[{id:s,name:a,size:0,type:"text/uri-list",source:"S3",status:"uploading",createdAt:Date.now()},...e]);let r=await fetch("/api/ingestion/s3",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceUri:a})}),l=await r.json(),n=eb(l),o=n.sourceIdentifier??a,i=(0,A.Me)(n.sourceType,o,"s3")??"s3";if(Z(e=>e.map(e=>e.id===s?{...e,status:r.ok?"success":"error",cleansedId:n.cleansedId??e.cleansedId,backendStatus:n.status??(r.ok?"ACCEPTED":e.backendStatus),backendMessage:n.message??e.backendMessage,sourceIdentifier:o,sourceType:i}:e)),el({state:r.ok?"success":"error",message:r.ok?"Source accepted.":"Backend rejected the S3/classpath request."}),!r.ok){et({state:"error",message:n.message??"Backend rejected the request."}),eo(!1);return}let d={name:a,size:0,source:(0,A.VG)(i,"S3 / Cloud"),cleansedId:n.cleansedId,status:n.status,uploadedAt:Date.now(),sourceIdentifier:o,sourceType:i},c=n.cleansedId??s,u=!1;if(c){let e=await eg(c,{mode:"s3",metadata:d,sourceUri:a,backendPayload:l});u=e.ok,t=e.snapshotId,e.ok||console.warn("Unable to cache S3 extraction snapshot, falling back to session storage metadata only.",e.message)}let p=(0,k.Wq)({mode:"s3",metadata:d,sourceUri:a,snapshotId:u?t??c:void 0,backendPayload:u?void 0:l});if(!p.ok){et({state:"error",message:E(p)}),eo(!1);return}et({state:"success",message:"Extraction ready. Redirecting..."}),eo(!1),e.push("/extraction")},eb=e=>{let t=e?.body,a=e?.rawBody,s=t&&"object"==typeof t&&!Array.isArray(t)?t:null,r=s?.metadata&&"object"==typeof s.metadata?s.metadata:null,l=(0,A.Xl)(s?.cleansedDataStoreId)??(0,A.Xl)(s?.cleansedId)??(0,A.Xl)(s?.id),n=(0,A.Xl)(s?.status),o=e=>{let t=(0,A.Xl)(e);if(t)return t;if(e&&"object"==typeof e)for(let t of[e.error,e.message,e.detail,e.statusText,e.description]){let e=(0,A.Xl)(t);if(e)return e}},i=(0,A.Xl)(s?.sourceIdentifier)??(0,A.Xl)(s?.sourceUri)??(0,A.Xl)(r?.sourceIdentifier)??(0,A.Xl)(r?.sourceUri)??(0,A.Xl)(e?.sourceIdentifier)??(0,A.Xl)(e?.sourceUri),d=(0,A.Me)((0,A.Xl)(s?.sourceType)??(0,A.Xl)(r?.sourceType),i);return{cleansedId:l,status:n,message:o(t)??o(e?.error)??o(a)??("string"==typeof a?a:void 0),sourceIdentifier:i,sourceType:d}},eg=async(e,t)=>{if(!e)return{ok:!1,message:"Snapshot id is missing."};let a={...t,storedAt:Date.now()};try{let a=await fetch("/api/ingestion/context",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,payload:{...t,mode:t.mode,metadata:t.metadata,rawJson:t.rawJson,tree:t.tree,sourceUri:t.sourceUri,backendPayload:t.backendPayload}})});if(!a.ok){let e="Failed to cache extraction snapshot.";try{let t=await a.json();t?.error&&(e=t.error)}catch{}throw Error(e)}return{ok:!0,snapshotId:e}}catch(r){let t=`local:${e}`,s=await (0,N.T)(t,a);if(s.ok)return{ok:!0,snapshotId:t};return{ok:!1,message:s.message??(r instanceof Error?r.message:"Failed to cache extraction snapshot.")}}},ew=e=>{Z(t=>t.filter(t=>t.id!==e))},ey=async e=>{if(!e.cleansedId){window.alert("Download is available after the backend returns a cleansed ID.");return}K(e.id);try{let t=await fetch(`/api/ingestion/resume/${encodeURIComponent(e.cleansedId)}`,{method:"POST"}),a=await t.json();if(!t.ok)throw Error(a?.error??"Backend rejected the download request.");let s="object"==typeof a.body&&null!==a.body?JSON.stringify(a.body,null,2):"string"==typeof a.rawBody&&a.rawBody.trim()?a.rawBody:JSON.stringify(a,null,2),r=new Blob([s],{type:"application/json"}),l=e.name.split("/").pop()?.replace(/[^\w.-]+/g,"_")||"upload",n=`${l}-${e.cleansedId}.json`,o=URL.createObjectURL(r),i=document.createElement("a");i.href=o,i.download=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)}catch(e){console.error("Unable to download upload payload.",e),window.alert(e instanceof Error?e.message:"Unable to download this upload. Please try again later.")}finally{K(t=>t===e.id?null:t)}},ev=e=>{G(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},ej=e=>e.map(e=>{let t=!!e.children?.length,a=_.has(e.id);return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 rounded-lg px-2 py-1.5",children:[t?(0,s.jsx)("button",{type:"button",onClick:()=>ev(e.id),className:"text-slate-500 transition hover:text-slate-800","aria-label":a?"Collapse section":"Expand section",children:a?(0,s.jsx)(u.A,{className:"size-4"}):(0,s.jsx)(p.A,{className:"size-4"})}):(0,s.jsx)("span",{className:"size-4"}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.label}),!t&&(0,s.jsx)("span",{className:"text-xs text-slate-500",children:e.path})]})]}),t&&a&&(0,s.jsx)("div",{className:"border-l border-slate-100 pl-4",children:ej(e.children)})]},e.id)});return(0,s.jsxs)(y.l,{currentStep:"ingestion",children:[(0,s.jsx)(v.F,{title:"Ingestion",description:"Upload local JSON files, paste API payloads, or reference cloud storage to kick off the pipeline."}),(0,s.jsxs)("main",{className:"mx-auto grid max-w-6xl gap-6 px-6 py-10 lg:grid-cols-[minmax(0,1.6fr)_minmax(0,1fr)]",children:[(0,s.jsxs)("section",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Ingestion"}),(0,s.jsx)("h2",{className:"mt-1 text-xl font-semibold text-slate-900",children:"Upload Files"}),(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"Drag and drop JSON, paste payloads, or point at S3/classpath URIs."})]}),(0,s.jsx)(U,{feedback:ee})]}),(0,s.jsx)("div",{className:"mt-6 grid gap-3 sm:grid-cols-3",children:S.map(e=>(0,s.jsx)("button",{type:"button",disabled:e.disabled,onClick:()=>!e.disabled&&C(e.id),className:(0,g.A)("rounded-2xl border px-4 py-3 text-left transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-900/50",e.disabled?"border-dashed border-slate-200 text-slate-400":c===e.id?"border-slate-900 bg-slate-900/[0.04] shadow-[0_18px_35px_rgba(15,23,42,0.12)]":"border-slate-200 hover:border-slate-900/40"),children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(e.icon,{className:(0,g.A)("size-5 transition-colors",e.disabled?"text-slate-300":c===e.id?"text-slate-900":"text-slate-700")}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:e.title}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:e.description})]})]})},e.id))}),"local"===c&&(0,s.jsx)("div",{className:"mt-6 rounded-2xl border border-dashed border-slate-300 bg-slate-50 p-6 text-center",children:(0,s.jsxs)("label",{htmlFor:"file-upload",onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation(),eu(e.dataTransfer.files)},className:"flex cursor-pointer flex-col items-center gap-4",children:[(0,s.jsx)(l.A,{className:"size-10 text-slate-900"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-sm font-semibold text-slate-900",children:["Drag a JSON file here or"," ",(0,s.jsx)("span",{className:"underline decoration-slate-900/40",children:"browse"})]}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Single-file uploads only. Max 50 MB."}),D&&(0,s.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["Selected: ",(0,s.jsx)("span",{className:"font-semibold text-slate-800",children:D.name})]})]}),(0,s.jsx)("input",{id:"file-upload",ref:t,type:"file",className:"sr-only",accept:".json,application/json",onChange:e=>eu(e.target.files)})]})}),"api"===c&&(0,s.jsxs)("div",{className:"mt-6 space-y-4 rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold text-slate-900",children:[(0,s.jsx)(o,{className:"size-5 text-slate-900"}),"POST /api/ingest-json-payload"]}),(0,s.jsx)("textarea",{value:B,onChange:e=>{R(e.target.value);let t=P(e.target.value);t&&(ec("API payload",t),es({state:"idle"}),em(e.target.value.length))},rows:6,placeholder:'Paste JSON payload. Example: { "product": { "name": "Vision Pro" } }',className:"w-full rounded-xl border border-slate-200 bg-white p-3 text-sm text-slate-900 shadow-inner focus:border-indigo-500 focus:outline-none"}),(0,s.jsx)(U,{feedback:ea})]}),"s3"===c&&(0,s.jsxs)("div",{className:"mt-6 space-y-4 rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold text-slate-900",children:[(0,s.jsx)(r.A,{className:"size-5 text-slate-900"}),"GET /api/extract-cleanse-enrich-and-store"]}),(0,s.jsx)("input",{value:z,onChange:e=>J(e.target.value),placeholder:"s3://my-bucket/path/to/file.json",className:"w-full rounded-xl border border-slate-200 bg-white p-3 text-sm text-slate-900 shadow-inner focus:border-indigo-500 focus:outline-none"}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Accepts s3://bucket/key or classpath:relative/path references that the Spring Boot service can access."}),(0,s.jsx)(U,{feedback:er})]})]}),(0,s.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"Upload History"}),(0,s.jsxs)("div",{className:"relative w-full max-w-xs",children:[(0,s.jsx)(m.A,{className:"pointer-events-none absolute left-3 top-2.5 size-4 text-slate-400"}),(0,s.jsx)("input",{type:"search",placeholder:"Search coming soon",className:"w-full cursor-not-allowed rounded-full border border-slate-200 bg-slate-50 py-2 pl-9 pr-3 text-sm text-slate-400",disabled:!0})]})]}),(0,s.jsxs)("div",{className:"mt-4 space-y-4",children:[0===H.length&&(0,s.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-200 py-10 text-center text-sm text-slate-500",children:"No uploads yet. Drop a JSON file to start the pipeline."}),H.map(e=>{let t=I[e.status],a=$===e.id;return(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 rounded-2xl border border-slate-100 bg-slate-50 px-4 py-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"rounded-2xl bg-white p-2 shadow-sm",children:(0,s.jsx)(h.A,{className:"size-5 text-slate-500"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-slate-500",children:[new Date(e.createdAt).toLocaleString()," • ",e.source]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.cleansedId&&(0,s.jsx)("code",{className:"rounded-full bg-white px-3 py-1 text-xs font-semibold text-slate-600 shadow-inner",children:e.cleansedId}),(0,s.jsxs)("span",{className:(0,g.A)("inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold",t.className),children:[(0,s.jsx)("span",{className:(0,g.A)("size-2 rounded-full",t.dot)}),t.label]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{type:"button",onClick:()=>ey(e),disabled:a,className:(0,g.A)("rounded-full p-1 text-slate-900 transition hover:bg-slate-900/10",a&&"cursor-wait opacity-60"),title:"Download payload","aria-label":"Download payload",children:(0,s.jsx)(x.A,{className:"size-4"})}),(0,s.jsx)("button",{type:"button",onClick:()=>ew(e.id),className:"rounded-full p-1 text-slate-900 transition hover:bg-slate-900/10",title:"Delete entry","aria-label":"Delete entry",children:(0,s.jsx)(f.A,{className:"size-4"})})]})]})]},e.id)})]})]})]}),(0,s.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Preview"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"Select Items"}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Preview is read-only. All fields will be sent forward."})]}),(0,s.jsxs)("span",{className:"text-sm font-semibold text-slate-600",children:[ed.length," fields"]})]}),(0,s.jsxs)("div",{className:"mt-4 flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1.5",children:[(0,s.jsx)(b.A,{className:"size-4 text-slate-500"}),(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-600",children:F})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(m.A,{className:"pointer-events-none absolute left-3 top-2.5 size-4 text-slate-400"}),(0,s.jsx)("input",{type:"search",placeholder:"Search fields...",value:X,onChange:e=>V(e.target.value),className:"w-full rounded-2xl border border-slate-200 bg-slate-50 py-2 pl-9 pr-3 text-sm text-slate-900 focus:border-indigo-500 focus:bg-white focus:outline-none"})]}),(0,s.jsx)("div",{className:"mt-4 max-h-[420px] overflow-y-auto pr-2",children:0===ei.length?(0,s.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-200 py-10 text-center text-sm text-slate-500",children:"Upload a JSON payload to view its structure."}):(0,s.jsx)("div",{className:"space-y-3",children:ej(ei)})})]}),(0,s.jsxs)("div",{className:"mt-6 rounded-2xl bg-slate-50 p-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-600",children:[(0,s.jsx)("span",{className:"font-semibold text-slate-800",children:"Fields:"}),ed.slice(0,6).map(e=>(0,s.jsx)("span",{className:"rounded-full bg-white px-3 py-1 font-semibold shadow-sm",children:e.label},e.id)),ed.length>6&&(0,s.jsxs)("span",{className:"rounded-full bg-white px-3 py-1 font-semibold shadow-sm",children:["+",ed.length-6," more"]})]}),(0,s.jsx)("button",{type:"button",onClick:ep,disabled:en,className:(0,g.A)("mt-4 w-full rounded-full bg-slate-900 py-2.5 text-sm font-semibold text-white transition hover:bg-black",en&&"cursor-not-allowed opacity-60 hover:bg-slate-900"),children:en?(0,s.jsxs)("span",{className:"inline-flex items-center justify-center gap-2",children:[(0,s.jsx)(i.A,{className:"size-4 animate-spin"}),"Extracting…"]}):"Extract Data"})]})]})]})]})}},3838:(e,t,a)=>{"use strict";a.d(t,{C:()=>n,T:()=>l});let s="snapshots",r=()=>new Promise((e,t)=>{t(Error("IndexedDB is not available in this environment."))}),l=async(e,t)=>{try{let a=await r();return await new Promise((r,l)=>{let n=a.transaction(s,"readwrite").objectStore(s).put(t,e);n.onsuccess=()=>r(),n.onerror=()=>l(n.error??Error("Failed to store snapshot."))}),{ok:!0}}catch(e){return{ok:!1,message:e instanceof Error?e.message:"Failed to store snapshot in IndexedDB."}}},n=async e=>{try{let t=await r();return await new Promise((a,r)=>{let l=t.transaction(s,"readonly").objectStore(s).get(e);l.onsuccess=()=>a(l.result??null),l.onerror=()=>r(l.error??Error("Failed to read snapshot."))})}catch{return null}}},3779:(e,t,a)=>{"use strict";a.d(t,{DV:()=>u,Wq:()=>n,mv:()=>c,q6:()=>m,qv:()=>i,rS:()=>h,sB:()=>p,wo:()=>x,xj:()=>o});let s="cleansed-context",r=(e,t)=>({ok:!1,reason:"ssr"}),l=e=>{let t={...e,backendPayload:void 0};return"string"==typeof t.rawJson&&t.rawJson.length>5e5&&(t.rawJson=t.rawJson.slice(0,5e5)),t},n=e=>r("extraction-context",l(e)),o=()=>null,i=()=>{},d=e=>{let t={...e,items:Array.isArray(e.items)?[...e.items]:[]};return t.items.length>150&&(t.items=t.items.slice(0,150),t.itemsTruncated=!0),"string"==typeof t.rawBody&&t.rawBody.length>2e5&&(t.rawBody=t.rawBody.slice(0,2e5),t.rawBodyTruncated=!0),t},c=e=>{let t=d(e),a=r(s,t);if(!a.ok&&"quota"===a.reason){let e=r(s,{metadata:t.metadata,status:t.status,items:[],fallbackReason:"quota"});return e.ok?{ok:!0,reason:"quota",usedFallback:!0}:e}return a},u=()=>null,p=()=>{},m=e=>r("enrichment-context",e),h=()=>null,x=()=>{}},6193:(e,t,a)=>{"use strict";a.d(t,{Me:()=>r,VG:()=>l,Xl:()=>s});let s=e=>{if("string"!=typeof e)return;let t=e.trim();return t.length?t:void 0},r=(e,t,a)=>{let s=e?.toLowerCase();if(s)return s;if(!t)return a;let r=t.toLowerCase();return r.startsWith("file-upload")||r.startsWith("local:")?"file":r.startsWith("api-payload")||r.includes("api")?"api":r.startsWith("s3://")||r.includes("s3")?"s3":r.startsWith("classpath:")?"classpath":a},l=(e,t="Unknown source")=>{if(!e)return t;let a=e.toLowerCase();return a.includes("api")?"API payload":a.includes("s3")||a.includes("cloud")?"S3 / Cloud":a.includes("class")?"Classpath resource":a.includes("local")?"Local upload":a.includes("file")?"File upload":e}},868:(e,t,a)=>{"use strict";a.d(t,{HW:()=>l,bZ:()=>r,hV:()=>n});let s=e=>"object"==typeof e&&null!==e&&!Array.isArray(e),r=(e,t=[],a={value:0})=>a.value>=5e3?[]:Array.isArray(e)?e.slice(0,100).flatMap((e,l)=>{let n=`[${l}]`,o=[...t,n].join(".");if(a.value+=1,a.value>=5e3)return[];let i=r(e,[...t,n],a);return[{id:o,label:n,path:o,type:Array.isArray(e)?"array":s(e)?"object":"value",children:i.length?i:void 0,value:Array.isArray(e)||s(e)?0===i.length?e:void 0:e}]}):s(e)?Object.entries(e).flatMap(([e,l])=>{if(a.value>=5e3)return[];let n=[...t,e].join(".");a.value+=1;let o=r(l,[...t,e],a);return[{id:n,label:e,path:n,type:Array.isArray(l)?"array":s(l)?"object":"value",children:o.length?o:void 0,value:Array.isArray(l)||s(l)?0===o.length?l:void 0:l}]}):[],l=e=>e.children&&0!==e.children.length?e.children.flatMap(e=>l(e)):[e],n=(e,t)=>{if(!t)return e;let a=t.toLowerCase(),s=e=>{let t=e.label.toLowerCase().includes(a);if(!e.children||0===e.children.length)return t?e:null;let r=e.children.map(s).filter(e=>!!e);return t||r.length>0?{...e,children:r.length?r:void 0}:null};return e.map(s).filter(e=>!!e)}},7068:(e,t,a)=>{"use strict";a.d(t,{Vj:()=>r,cB:()=>s});let s=()=>[],r=e=>{}},7896:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/ingestion/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/darshanchipade/Documents/GitHub/UserFlow/UserFlow/src/app/ingestion/page.tsx","default")},4193:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(8009);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))})},4454:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(8009);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))})},788:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(8009);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))})},8483:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(8009);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))})},8523:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(8009);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))})},9174:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(8009);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))})},6389:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(8009);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))})},9356:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(8009);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m7.875 14.25 1.214 1.942a2.25 2.25 0 0 0 1.908 1.058h2.006c.776 0 1.497-.4 1.908-1.058l1.214-1.942M2.41 9h4.636a2.25 2.25 0 0 1 1.872 1.002l.164.246a2.25 2.25 0 0 0 1.872 1.002h2.092a2.25 2.25 0 0 0 1.872-1.002l.164-.246A2.25 2.25 0 0 1 16.954 9h4.636M2.41 9a2.25 2.25 0 0 0-.16.832V12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 12V9.832c0-.287-.055-.57-.16-.832M2.41 9a2.25 2.25 0 0 1 .382-.632l3.285-3.832a2.25 2.25 0 0 1 1.708-.786h8.43c.657 0 1.281.287 1.709.786l3.284 3.832c.163.19.291.404.382.632M4.5 20.25h15A2.25 2.25 0 0 0 21.75 18v-2.625c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125V18a2.25 2.25 0 0 0 2.25 2.25Z"}))})},8390:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(8009);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[638,619,77,30,546],()=>a(927));module.exports=s})();